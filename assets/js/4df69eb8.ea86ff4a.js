"use strict";(globalThis.webpackChunkDocuQuest_oslar_code=globalThis.webpackChunkDocuQuest_oslar_code||[]).push([[5627],{3177:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"backend/sqlite/busquedaFTS5","title":"B\xfasqueda de texto completo con FTS5","description":"1. Qu\xe9 es FTS5 y cu\xe1ndo usarlo","source":"@site/docs/backend/sqlite/busquedaFTS5.md","sourceDirName":"backend/sqlite","slug":"/backend/sqlite/busquedaFTS5","permalink":"/docuQuest/docs/backend/sqlite/busquedaFTS5","draft":false,"unlisted":false,"editUrl":"https://github.com/OslarCode/OslarCode/docs/backend/sqlite/busquedaFTS5.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"JSON y estructuras din\xe1micas","permalink":"/docuQuest/docs/backend/sqlite/JSON"},"next":{"title":"Extensiones y funciones personalizadas","permalink":"/docuQuest/docs/backend/sqlite/extensionesYFunciones"}}');var a=s(4848),r=s(8453);const l={},c="B\xfasqueda de texto completo con FTS5",d={},o=[{value:"1. Qu\xe9 es FTS5 y cu\xe1ndo usarlo",id:"1-qu\xe9-es-fts5-y-cu\xe1ndo-usarlo",level:2},{value:"2. Creando tu primera tabla FTS5",id:"2-creando-tu-primera-tabla-fts5",level:2},{value:"3. Buscando con <code>MATCH</code>",id:"3-buscando-con-match",level:2},{value:"4. B\xfasqueda con operadores y frases",id:"4-b\xfasqueda-con-operadores-y-frases",level:2},{value:"\ud83d\udccc Palabras m\xfaltiples (OR impl\xedcito)",id:"-palabras-m\xfaltiples-or-impl\xedcito",level:3},{value:"Palabras exactas (frase entre comillas)",id:"palabras-exactas-frase-entre-comillas",level:3},{value:"Operadores l\xf3gicos",id:"operadores-l\xf3gicos",level:3},{value:"5. Ranking de resultados \u2014 <code>bm25</code>",id:"5-ranking-de-resultados--bm25",level:2},{value:"6. Resaltado de coincidencias \u2014 <code>highlight</code>",id:"6-resaltado-de-coincidencias--highlight",level:2},{value:"7. Ejercicio pr\xe1ctico \u2014 Buscador b\xe1sico",id:"7-ejercicio-pr\xe1ctico--buscador-b\xe1sico",level:2},{value:"8. Cu\xe1ndo usar FTS5 (y cu\xe1ndo no)",id:"8-cu\xe1ndo-usar-fts5-y-cu\xe1ndo-no",level:2},{value:"9. Errores comunes al usar FTS5",id:"9-errores-comunes-al-usar-fts5",level:2},{value:"10. Buenas pr\xe1cticas iniciales con FTS5",id:"10-buenas-pr\xe1cticas-iniciales-con-fts5",level:2},{value:"1. Qu\xe9 es la tokenizaci\xf3n",id:"1-qu\xe9-es-la-tokenizaci\xf3n",level:2},{value:"2. Tokenizadores disponibles",id:"2-tokenizadores-disponibles",level:2},{value:"Ejemplo con <code>porter</code>",id:"ejemplo-con-porter",level:3},{value:"3. <code>unicode61</code>: el recomendado para espa\xf1ol y otros idiomas",id:"3-unicode61-el-recomendado-para-espa\xf1ol-y-otros-idiomas",level:2},{value:"4. Stopwords \u2014 excluir palabras comunes",id:"4-stopwords--excluir-palabras-comunes",level:2},{value:"Ejemplo:",id:"ejemplo",level:3},{value:"5. Stemming en espa\xf1ol (opcional)",id:"5-stemming-en-espa\xf1ol-opcional",level:2},{value:"6. Sincronizar FTS con una tabla real",id:"6-sincronizar-fts-con-una-tabla-real",level:2},{value:"Tabla principal",id:"tabla-principal",level:3},{value:"Tabla FTS vinculada",id:"tabla-fts-vinculada",level:3},{value:"7. Sincronizar autom\xe1ticamente con <code>triggers</code>",id:"7-sincronizar-autom\xe1ticamente-con-triggers",level:2},{value:"8. Ejemplo pr\xe1ctico \u2014 tabla sincronizada",id:"8-ejemplo-pr\xe1ctico--tabla-sincronizada",level:2},{value:"9. Reindexar manualmente si es necesario",id:"9-reindexar-manualmente-si-es-necesario",level:2},{value:"10. Buenas pr\xe1cticas con tokenizaci\xf3n y sincronizaci\xf3n",id:"10-buenas-pr\xe1cticas-con-tokenizaci\xf3n-y-sincronizaci\xf3n",level:2},{value:"Errores comunes",id:"errores-comunes",level:2}];function t(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"b\xfasqueda-de-texto-completo-con-fts5",children:"B\xfasqueda de texto completo con FTS5"})}),"\n",(0,a.jsx)(n.h2,{id:"1-qu\xe9-es-fts5-y-cu\xe1ndo-usarlo",children:"1. Qu\xe9 es FTS5 y cu\xe1ndo usarlo"}),"\n",(0,a.jsx)(n.p,{children:"Normalmente, si haces:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM articles WHERE content LIKE '%sqlite%';\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"SQLite:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Recorre todas las filas (",(0,a.jsx)(n.code,{children:"SCAN TABLE"}),")."]}),"\n",(0,a.jsx)(n.li,{children:"Es lento si tienes miles de registros."}),"\n",(0,a.jsx)(n.li,{children:"No entiende relevancia ni palabras parciales."}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["FTS5 crea un ",(0,a.jsx)(n.strong,{children:"\xedndice especializado para texto"}),", con el que puedes:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Buscar texto ",(0,a.jsx)(n.strong,{children:"mucho m\xe1s r\xe1pido"})," que con ",(0,a.jsx)(n.code,{children:"LIKE"}),"."]}),"\n",(0,a.jsx)(n.li,{children:"Hacer b\xfasquedas por palabras y frases."}),"\n",(0,a.jsx)(n.li,{children:"Obtener puntuaciones de relevancia."}),"\n",(0,a.jsx)(n.li,{children:"Usar tokenizaci\xf3n (romper el texto en palabras)."}),"\n",(0,a.jsx)(n.li,{children:"Sincronizarlo con tus tablas reales."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Casos de uso reales:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Buscadores en blogs, foros, tiendas online, documentaci\xf3n interna, aplicaciones de notas, etc."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"2-creando-tu-primera-tabla-fts5",children:"2. Creando tu primera tabla FTS5"}),"\n",(0,a.jsx)(n.p,{children:"A diferencia de las tablas normales, FTS5 se crea as\xed:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE VIRTUAL TABLE articles\nUSING fts5(title, content);\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"VIRTUAL TABLE"})," indica que es una tabla especial."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"fts5"})," es el m\xf3dulo que proporciona el motor de b\xfasqueda."]}),"\n",(0,a.jsx)(n.p,{children:"Puedes tener uno o varios campos indexados."}),"\n",(0,a.jsx)(n.p,{children:"Insertar algunos art\xedculos:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"INSERT INTO articles (title, content) VALUES\n('Bienvenido a SQLite', 'SQLite es una base de datos ligera y embebida.'),\n('FTS5 en acci\xf3n', 'FTS5 permite realizar b\xfasquedas de texto completas y r\xe1pidas.'),\n('JSON1 y flexibilidad', 'La extensi\xf3n JSON1 permite almacenar datos din\xe1micos.');\n\n"})}),"\n",(0,a.jsxs)(n.h2,{id:"3-buscando-con-match",children:["3. Buscando con ",(0,a.jsx)(n.code,{children:"MATCH"})]}),"\n",(0,a.jsxs)(n.p,{children:["Para buscar, no se usa ",(0,a.jsx)(n.code,{children:"LIKE"}),", sino:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM articles WHERE articles MATCH 'SQLite';\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"Resultado:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"title                | content\n----------------------|--------------------------------------------\nBienvenido a SQLite   | SQLite es una base de datos ligera y embebida.\nFTS5 en acci\xf3n        | FTS5 permite realizar b\xfasquedas de texto completas y r\xe1pidas.\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["FTS5 busca coincidencias en ",(0,a.jsx)(n.strong,{children:"todos los campos indexados"})," por defecto."]}),"\n",(0,a.jsx)(n.p,{children:"Tambi\xe9n puedes limitar a un campo espec\xedfico:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM articles WHERE title MATCH 'FTS5';\n\n"})}),"\n",(0,a.jsx)(n.h2,{id:"4-b\xfasqueda-con-operadores-y-frases",children:"4. B\xfasqueda con operadores y frases"}),"\n",(0,a.jsxs)(n.p,{children:["FTS5 permite hacer b\xfasquedas m\xe1s expresivas que ",(0,a.jsx)(n.code,{children:"LIKE"}),"."]}),"\n",(0,a.jsx)(n.h3,{id:"-palabras-m\xfaltiples-or-impl\xedcito",children:"\ud83d\udccc Palabras m\xfaltiples (OR impl\xedcito)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM articles WHERE articles MATCH 'SQLite FTS5';\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Devuelve filas que contengan ",(0,a.jsx)(n.strong,{children:"al menos una"})," de las palabras."]}),"\n",(0,a.jsx)(n.h3,{id:"palabras-exactas-frase-entre-comillas",children:"Palabras exactas (frase entre comillas)"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM articles WHERE articles MATCH '\"b\xfasquedas de texto\"';\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"Devuelve filas con esa frase exacta."}),"\n",(0,a.jsx)(n.h3,{id:"operadores-l\xf3gicos",children:"Operadores l\xf3gicos"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM articles WHERE articles MATCH 'SQLite AND embebida';\nSELECT * FROM articles WHERE articles MATCH 'SQLite NOT JSON1';\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["FTS5 ",(0,a.jsx)(n.strong,{children:"ignora may\xfasculas/min\xfasculas"})," por defecto."]}),"\n",(0,a.jsxs)(n.h2,{id:"5-ranking-de-resultados--bm25",children:["5. Ranking de resultados \u2014 ",(0,a.jsx)(n.code,{children:"bm25"})]}),"\n",(0,a.jsxs)(n.p,{children:["FTS5 no solo busca: tambi\xe9n ",(0,a.jsx)(n.strong,{children:"calcula relevancia"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["La funci\xf3n ",(0,a.jsx)(n.code,{children:"bm25()"})," te da un puntaje de relevancia basado en frecuencia y posici\xf3n de las palabras."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT title, bm25(articles) AS score\nFROM articles\nWHERE articles MATCH 'SQLite'\nORDER BY score;\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Cuanto ",(0,a.jsx)(n.strong,{children:"m\xe1s bajo"})," el score, ",(0,a.jsx)(n.strong,{children:"m\xe1s relevante"})," es el resultado."]}),"\n",(0,a.jsx)(n.p,{children:"(FTS5 usa un modelo inverso a muchas librer\xedas)."}),"\n",(0,a.jsxs)(n.h2,{id:"6-resaltado-de-coincidencias--highlight",children:["6. Resaltado de coincidencias \u2014 ",(0,a.jsx)(n.code,{children:"highlight"})]}),"\n",(0,a.jsx)(n.p,{children:"Puedes destacar las palabras encontradas directamente en SQL:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT highlight(articles, 1, '[', ']')\nFROM articles\nWHERE articles MATCH 'SQLite';\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"1"})," = \xedndice de columna (0 = title, 1 = content)."]}),"\n",(0,a.jsxs)(n.p,{children:["Los textos encontrados aparecer\xe1n envueltos en ",(0,a.jsx)(n.code,{children:"["})," y ",(0,a.jsx)(n.code,{children:"]"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Ejemplo de salida:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"SQLite es una base de datos ligera y embebida.\n\u2193\n[SQLite] es una base de datos ligera y embebida.\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Esto es ",(0,a.jsx)(n.strong,{children:"muy \xfatil en interfaces web"})," para mostrar resultados resaltados."]}),"\n",(0,a.jsx)(n.h2,{id:"7-ejercicio-pr\xe1ctico--buscador-b\xe1sico",children:"7. Ejercicio pr\xe1ctico \u2014 Buscador b\xe1sico"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Crear tabla FTS5:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE VIRTUAL TABLE notes USING fts5(title, body);\n\n"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Insertar datos:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"INSERT INTO notes (title, body) VALUES\n('Introducci\xf3n a SQLite', 'SQLite es r\xe1pido, ligero y sin servidor.'),\n('JSON y estructuras flexibles', 'JSON1 a\xf1ade potencia a SQLite.'),\n('FTS5 en acci\xf3n', 'Con FTS5 puedes buscar texto como si fuera Google.');\n\n"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Buscar:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT title FROM notes WHERE notes MATCH 'SQLite';\n\n"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Buscar frases exactas:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT title FROM notes WHERE notes MATCH '\"texto como\"';\n\n"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Ranking de resultados:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT title, bm25(notes) AS relevancia\nFROM notes\nWHERE notes MATCH 'SQLite'\nORDER BY relevancia;\n\n"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Resaltado:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT highlight(notes, 1, '>>', '<<') AS body_highlight\nFROM notes\nWHERE notes MATCH 'SQLite';\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Ya tienes un buscador ",(0,a.jsx)(n.strong,{children:"completo y r\xe1pido"})," directamente dentro de SQLite."]}),"\n",(0,a.jsx)(n.h2,{id:"8-cu\xe1ndo-usar-fts5-y-cu\xe1ndo-no",children:"8. Cu\xe1ndo usar FTS5 (y cu\xe1ndo no)"}),"\n",(0,a.jsx)(n.p,{children:"Ideal cuando:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Necesitas b\xfasquedas textuales potentes."}),"\n",(0,a.jsxs)(n.li,{children:["Tienes muchos registros y ",(0,a.jsx)(n.code,{children:"LIKE"})," no escala."]}),"\n",(0,a.jsx)(n.li,{children:"Quieres ofrecer relevancia y frases exactas."}),"\n",(0,a.jsx)(n.li,{children:"No quieres depender de motores externos (como Elasticsearch o Solr)."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"No recomendado si:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Tienes poco texto y consultas simples (un \xedndice normal podr\xeda bastar)."}),"\n",(0,a.jsx)(n.li,{children:"Necesitas b\xfasquedas num\xe9ricas, de rangos, geoespaciales o muy estructuradas."}),"\n",(0,a.jsx)(n.li,{children:"No puedes permitirte mantener el \xedndice sincronizado (aunque esto se puede automatizar)."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"9-errores-comunes-al-usar-fts5",children:"9. Errores comunes al usar FTS5"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Error / s\xedntoma"}),(0,a.jsx)(n.th,{children:"Causa"}),(0,a.jsx)(n.th,{children:"Soluci\xf3n"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"\u201cno such module: fts5\u201d"}),(0,a.jsx)(n.td,{children:"SQLite antiguo"}),(0,a.jsx)(n.td,{children:"Actualiza SQLite a una versi\xf3n moderna"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"B\xfasqueda lenta"}),(0,a.jsx)(n.td,{children:"No usar MATCH"}),(0,a.jsxs)(n.td,{children:["Usa ",(0,a.jsx)(n.code,{children:"MATCH"})," en lugar de ",(0,a.jsx)(n.code,{children:"LIKE"})]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Resultados vac\xedos"}),(0,a.jsx)(n.td,{children:"B\xfasqueda sensible a tokenizaci\xf3n"}),(0,a.jsx)(n.td,{children:"Revisa el texto insertado y los operadores"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Resultados sin orden"}),(0,a.jsxs)(n.td,{children:["No usar ",(0,a.jsx)(n.code,{children:"bm25()"})]}),(0,a.jsx)(n.td,{children:"A\xf1ade orden por relevancia"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Highlight no muestra coincidencia"}),(0,a.jsx)(n.td,{children:"\xcdndice de columna incorrecto"}),(0,a.jsx)(n.td,{children:"Usa 0 o 1 seg\xfan el campo"})]})]})]}),"\n",(0,a.jsx)(n.h2,{id:"10-buenas-pr\xe1cticas-iniciales-con-fts5",children:"10. Buenas pr\xe1cticas iniciales con FTS5"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Usa ",(0,a.jsx)(n.code,{children:"MATCH"})," para b\xfasquedas, no ",(0,a.jsx)(n.code,{children:"LIKE"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:["Aprovecha ",(0,a.jsx)(n.code,{children:"bm25()"})," para ranking."]}),"\n",(0,a.jsxs)(n.li,{children:["Usa ",(0,a.jsx)(n.code,{children:"highlight()"})," para mostrar resultados de forma amigable."]}),"\n",(0,a.jsx)(n.li,{children:"Mant\xe9n tus textos limpios y bien tokenizados (sin HTML innecesario si es posible)."}),"\n",(0,a.jsx)(n.li,{children:"No indexar campos innecesarios \u2014 solo los que realmente quieras buscar."}),"\n",(0,a.jsx)(n.li,{children:"Revisa c\xf3mo FTS tokeniza tu idioma (m\xe1s sobre esto en la segunda parte)."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"1-qu\xe9-es-la-tokenizaci\xf3n",children:"1. Qu\xe9 es la tokenizaci\xf3n"}),"\n",(0,a.jsxs)(n.p,{children:["La ",(0,a.jsx)(n.strong,{children:"tokenizaci\xf3n"})," es el proceso mediante el cual FTS5 toma un texto y lo ",(0,a.jsx)(n.strong,{children:"divide en palabras"})," (tokens) para indexarlas."]}),"\n",(0,a.jsx)(n.p,{children:"Por defecto:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Separa por espacios y puntuaci\xf3n,"}),"\n",(0,a.jsx)(n.li,{children:"Convierte todo a min\xfasculas,"}),"\n",(0,a.jsx)(n.li,{children:"No hace stemming (no quita sufijos),"}),"\n",(0,a.jsx)(n.li,{children:"No quita palabras comunes (como \u201cel\u201d, \u201cla\u201d, \u201cde\u201d)."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Ejemplo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'"FTS5 es genial para b\xfasquedas r\xe1pidas."\n\u2192 ["fts5", "es", "genial", "para", "b\xfasquedas", "r\xe1pidas"]\n\n'})}),"\n",(0,a.jsx)(n.p,{children:"Esto es suficiente en muchos casos, pero se puede personalizar para mejorar la relevancia de los resultados."}),"\n",(0,a.jsx)(n.h2,{id:"2-tokenizadores-disponibles",children:"2. Tokenizadores disponibles"}),"\n",(0,a.jsxs)(n.p,{children:["SQLite FTS5 incluye varios ",(0,a.jsx)(n.strong,{children:"tokenizadores"}),". Los m\xe1s comunes:"]}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Tokenizador"}),(0,a.jsx)(n.th,{children:"Descripci\xf3n breve"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsxs)(n.td,{children:[(0,a.jsx)(n.code,{children:"simple"})," (por defecto)"]}),(0,a.jsx)(n.td,{children:"Divide por espacios y puntuaci\xf3n, sin stemming"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"porter"})}),(0,a.jsx)(n.td,{children:"Tokenizador en ingl\xe9s con stemming"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"unicode61"})}),(0,a.jsx)(n.td,{children:"Tokenizador avanzado compatible con unicode y stopwords"})]})]})]}),"\n",(0,a.jsxs)(n.h3,{id:"ejemplo-con-porter",children:["Ejemplo con ",(0,a.jsx)(n.code,{children:"porter"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE VIRTUAL TABLE docs USING fts5(content, tokenize = 'porter');\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"Si indexas \u201crunning\u201d y buscas \u201crun\u201d, lo encontrar\xe1."}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.em,{children:"(Stemming en ingl\xe9s \xfanicamente)"})}),"\n",(0,a.jsxs)(n.h2,{id:"3-unicode61-el-recomendado-para-espa\xf1ol-y-otros-idiomas",children:["3. ",(0,a.jsx)(n.code,{children:"unicode61"}),": el recomendado para espa\xf1ol y otros idiomas"]}),"\n",(0,a.jsxs)(n.p,{children:["El tokenizador ",(0,a.jsx)(n.code,{children:"unicode61"})," es el m\xe1s flexible y recomendado si trabajas con ",(0,a.jsx)(n.strong,{children:"texto en espa\xf1ol"})," (u otros idiomas no ingleses)."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE VIRTUAL TABLE docs\nUSING fts5(content, tokenize = 'unicode61');\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"Ventajas:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Soporta acentos, \xf1, etc."}),"\n",(0,a.jsx)(n.li,{children:"Maneja may\xfasculas y min\xfasculas correctamente."}),"\n",(0,a.jsx)(n.li,{children:"Puedes personalizar stopwords."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"\u201cInformaci\xf3n\u201d y \u201cinformacion\u201d se tratan igual."}),"\n",(0,a.jsx)(n.p,{children:"\u201cni\xf1o\u201d y \u201cnino\u201d tambi\xe9n."}),"\n",(0,a.jsx)(n.h2,{id:"4-stopwords--excluir-palabras-comunes",children:"4. Stopwords \u2014 excluir palabras comunes"}),"\n",(0,a.jsx)(n.p,{children:"Puedes excluir palabras \u201cruido\u201d para que no afecten la b\xfasqueda:"}),"\n",(0,a.jsx)(n.p,{children:"por ejemplo: \u201cel\u201d, \u201cla\u201d, \u201cde\u201d, \u201cpara\u201d, \u201cy\u201d, etc."}),"\n",(0,a.jsx)(n.h3,{id:"ejemplo",children:"Ejemplo:"}),"\n",(0,a.jsxs)(n.p,{children:["Crea un archivo ",(0,a.jsx)(n.code,{children:"stopwords_es.txt"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"el\nla\nde\ny\nen\npara\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"Luego:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE VIRTUAL TABLE docs\nUSING fts5(content, tokenize = 'unicode61 remove_diacritics 2',\n            stopwords = 'stopwords_es.txt');\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Ahora si buscas ",(0,a.jsx)(n.code,{children:"MATCH 'el'"})," \u2192 no devuelve nada (porque no se indexa)."]}),"\n",(0,a.jsxs)(n.p,{children:["Pero si buscas ",(0,a.jsx)(n.code,{children:"MATCH 'b\xfasqueda'"})," \u2192 resultados normales."]}),"\n",(0,a.jsxs)(n.p,{children:["Esto mejora la ",(0,a.jsx)(n.strong,{children:"precisi\xf3n y relevancia"})," en textos largos."]}),"\n",(0,a.jsx)(n.h2,{id:"5-stemming-en-espa\xf1ol-opcional",children:"5. Stemming en espa\xf1ol (opcional)"}),"\n",(0,a.jsxs)(n.p,{children:["FTS5 ",(0,a.jsx)(n.strong,{children:"no incluye stemming en espa\xf1ol de f\xe1brica"}),", pero:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Puedes usar ",(0,a.jsx)(n.code,{children:"unicode61"})," + stopwords \u2192 mejora bastante."]}),"\n",(0,a.jsx)(n.li,{children:"O implementar stemming ligero desde tu aplicaci\xf3n (preprocesando texto antes de insertarlo)."}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Por ejemplo: eliminar sufijos comunes (",(0,a.jsx)(n.code,{children:"-es"}),", ",(0,a.jsx)(n.code,{children:"-as"}),", ",(0,a.jsx)(n.code,{children:"-mente"}),", etc.) antes de insertar, si buscas m\xe1xima relevancia."]}),"\n",(0,a.jsx)(n.h2,{id:"6-sincronizar-fts-con-una-tabla-real",children:"6. Sincronizar FTS con una tabla real"}),"\n",(0,a.jsxs)(n.p,{children:["Hasta ahora, creamos tablas FTS que contienen ",(0,a.jsx)(n.strong,{children:"todo el contenido"})," directamente."]}),"\n",(0,a.jsxs)(n.p,{children:["Pero en proyectos reales, normalmente tienes una ",(0,a.jsx)(n.strong,{children:"tabla principal"})," con tus datos y una ",(0,a.jsx)(n.strong,{children:"tabla FTS sincronizada"})," que sirve solo para b\xfasqueda."]}),"\n",(0,a.jsx)(n.p,{children:"Esto permite:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Mantener integridad y estructura normalizada,"}),"\n",(0,a.jsx)(n.li,{children:"Separar la l\xf3gica de b\xfasqueda de los datos reales,"}),"\n",(0,a.jsx)(n.li,{children:"Reindexar sin afectar la tabla principal."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Ejemplo cl\xe1sico:"}),"\n",(0,a.jsx)(n.h3,{id:"tabla-principal",children:"Tabla principal"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE articles (\n  id INTEGER PRIMARY KEY,\n  title TEXT NOT NULL,\n  content TEXT NOT NULL\n);\n\n"})}),"\n",(0,a.jsx)(n.h3,{id:"tabla-fts-vinculada",children:"Tabla FTS vinculada"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE VIRTUAL TABLE articles_fts\nUSING fts5(title, content, content='articles', content_rowid='id');\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"content='articles'"})," le dice a FTS que su \u201cfuente de verdad\u201d es la tabla ",(0,a.jsx)(n.code,{children:"articles"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"content_rowid='id'"})," sincroniza cada documento con su ID real."]}),"\n",(0,a.jsxs)(n.h2,{id:"7-sincronizar-autom\xe1ticamente-con-triggers",children:["7. Sincronizar autom\xe1ticamente con ",(0,a.jsx)(n.code,{children:"triggers"})]}),"\n",(0,a.jsxs)(n.p,{children:["Para que los cambios en la tabla real se reflejen en la tabla FTS, usamos ",(0,a.jsx)(n.strong,{children:"triggers"}),":"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE TRIGGER articles_ai AFTER INSERT ON articles BEGIN\n  INSERT INTO articles_fts(rowid, title, content)\n  VALUES (new.id, new.title, new.content);\nEND;\n\nCREATE TRIGGER articles_ad AFTER DELETE ON articles BEGIN\n  DELETE FROM articles_fts WHERE rowid = old.id;\nEND;\n\nCREATE TRIGGER articles_au AFTER UPDATE ON articles BEGIN\n  UPDATE articles_fts\n  SET title = new.title, content = new.content\n  WHERE rowid = old.id;\nEND;\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Ahora, si insertas, borras o actualizas en ",(0,a.jsx)(n.code,{children:"articles"}),","]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"articles_fts"})," se actualiza autom\xe1ticamente."]}),"\n",(0,a.jsx)(n.h2,{id:"8-ejemplo-pr\xe1ctico--tabla-sincronizada",children:"8. Ejemplo pr\xe1ctico \u2014 tabla sincronizada"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Crear tabla principal:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE blog_posts (\n  id INTEGER PRIMARY KEY,\n  title TEXT,\n  body TEXT\n);\n\n"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Crear tabla FTS vinculada:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE VIRTUAL TABLE blog_posts_fts\nUSING fts5(title, body, content='blog_posts', content_rowid='id');\n\n"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Crear triggers:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"CREATE TRIGGER blog_posts_ai AFTER INSERT ON blog_posts BEGIN\n  INSERT INTO blog_posts_fts(rowid, title, body)\n  VALUES (new.id, new.title, new.body);\nEND;\n\nCREATE TRIGGER blog_posts_ad AFTER DELETE ON blog_posts BEGIN\n  DELETE FROM blog_posts_fts WHERE rowid = old.id;\nEND;\n\nCREATE TRIGGER blog_posts_au AFTER UPDATE ON blog_posts BEGIN\n  UPDATE blog_posts_fts\n  SET title = new.title, body = new.body\n  WHERE rowid = old.id;\nEND;\n\n"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Insertar datos en tabla principal:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"INSERT INTO blog_posts (title, body) VALUES\n('Primer post', 'Bienvenido a nuestro blog sobre SQLite.'),\n('Buscador con FTS5', 'Aprende a buscar texto completo con SQLite.');\n\n"})}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"Buscar en FTS:"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT title FROM blog_posts_fts WHERE blog_posts_fts MATCH 'SQLite';\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Aunque insertaste en ",(0,a.jsx)(n.code,{children:"blog_posts"}),", los triggers ",(0,a.jsx)(n.strong,{children:"mantienen sincronizada"})," la tabla FTS."]}),"\n",(0,a.jsx)(n.h2,{id:"9-reindexar-manualmente-si-es-necesario",children:"9. Reindexar manualmente si es necesario"}),"\n",(0,a.jsxs)(n.p,{children:["Si en alg\xfan momento los \xedndices FTS se pierden o quedan desincronizados (por ejemplo tras una importaci\xf3n masiva), puedes ",(0,a.jsx)(n.strong,{children:"regenerarlos"})," f\xe1cilmente:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"INSERT INTO blog_posts_fts(blog_posts_fts) VALUES('rebuild');\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Esto vuelve a indexar todo el contenido de ",(0,a.jsx)(n.code,{children:"blog_posts"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"Tambi\xe9n puedes borrar y recrear la tabla FTS si quieres un reinicio limpio."}),"\n",(0,a.jsx)(n.h2,{id:"10-buenas-pr\xe1cticas-con-tokenizaci\xf3n-y-sincronizaci\xf3n",children:"10. Buenas pr\xe1cticas con tokenizaci\xf3n y sincronizaci\xf3n"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Usa ",(0,a.jsx)(n.code,{children:"unicode61"})," si trabajas con espa\xf1ol u otros idiomas con tildes."]}),"\n",(0,a.jsx)(n.li,{children:"A\xf1ade stopwords para mejorar precisi\xf3n."}),"\n",(0,a.jsx)(n.li,{children:"Usa triggers para mantener sincron\xeda sin esfuerzo manual."}),"\n",(0,a.jsx)(n.li,{children:"Reindexa peri\xf3dicamente si haces grandes operaciones masivas."}),"\n",(0,a.jsxs)(n.li,{children:["Separa tu ",(0,a.jsx)(n.strong,{children:"tabla de datos"})," de tu ",(0,a.jsx)(n.strong,{children:"tabla de b\xfasqueda"})," para mayor flexibilidad."]}),"\n",(0,a.jsxs)(n.li,{children:["Usa ",(0,a.jsx)(n.code,{children:"EXPLAIN QUERY PLAN"})," si quieres entender el rendimiento."]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"errores-comunes",children:"Errores comunes"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Error / s\xedntoma"}),(0,a.jsx)(n.th,{children:"Causa"}),(0,a.jsx)(n.th,{children:"Soluci\xf3n"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Resultados inesperados"}),(0,a.jsx)(n.td,{children:"Tokenizador por defecto"}),(0,a.jsxs)(n.td,{children:["Usa ",(0,a.jsx)(n.code,{children:"unicode61"})," o ",(0,a.jsx)(n.code,{children:"porter"})," si aplica"]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"B\xfasquedas irrelevantes"}),(0,a.jsx)(n.td,{children:"Stopwords no definidas"}),(0,a.jsx)(n.td,{children:"Crea y usa un archivo de stopwords"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"Tabla FTS no se actualiza"}),(0,a.jsx)(n.td,{children:"No hay triggers"}),(0,a.jsx)(n.td,{children:"A\xf1adir triggers de sincronizaci\xf3n"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"FTS desincronizado tras importaci\xf3n"}),(0,a.jsx)(n.td,{children:"No se index\xf3"}),(0,a.jsxs)(n.td,{children:["Ejecutar ",(0,a.jsx)(n.code,{children:"INSERT INTO fts_table(fts_table) VALUES('rebuild');"})]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:"B\xfasqueda sensible a may\xfasculas/acentos"}),(0,a.jsx)(n.td,{children:"Tokenizador simple"}),(0,a.jsxs)(n.td,{children:["Cambiar a ",(0,a.jsx)(n.code,{children:"unicode61"})," con ",(0,a.jsx)(n.code,{children:"remove_diacritics"})]})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(t,{...e})}):t(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>c});var i=s(6540);const a={},r=i.createContext(a);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);