"use strict";(globalThis.webpackChunkDocuQuest_oslar_code=globalThis.webpackChunkDocuQuest_oslar_code||[]).push([[7877],{6683:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"backend/apiWeb/consumo","title":"Consumo de APIs web","description":"Hoy en d\xeda, las aplicaciones ya no funcionan solas: necesitan hablar con otros servicios. Para lograrlo, usan APIs web. Aprender a consumir APIs es esencial si quieres crear apps modernas y conectadas. En este recorrido, veremos c\xf3mo hacer peticiones HTTP usando Fetch y Axios, c\xf3mo manejar errores, c\xf3mo proteger tus peticiones con OAuth y JWT, y c\xf3mo aplicar todo esto tanto en el frontend como en el backend.","source":"@site/docs/backend/apiWeb/consumo.md","sourceDirName":"backend/apiWeb","slug":"/backend/apiWeb/consumo","permalink":"/docuQuest/docs/backend/apiWeb/consumo","draft":false,"unlisted":false,"editUrl":"https://github.com/OslarCode/OslarCode/docs/backend/apiWeb/consumo.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Dise\xf1o y documentaci\xf3n de APIs web","permalink":"/docuQuest/docs/backend/apiWeb/documentacion"},"next":{"title":"GraphQL","permalink":"/docuQuest/docs/backend/apiWeb/graphQL"}}');var o=r(4848),a=r(8453);const i={},t="Consumo de APIs web",c={},d=[{value:"Hacer peticiones HTTP: tu primer contacto con una API",id:"hacer-peticiones-http-tu-primer-contacto-con-una-api",level:2},{value:"Usar Fetch API",id:"usar-fetch-api",level:3},{value:"Usar Axios",id:"usar-axios",level:3},{value:"Uso moderno con async/await",id:"uso-moderno-con-asyncawait",level:3},{value:"Manejo de estados de carga y error en interfaces",id:"manejo-de-estados-de-carga-y-error-en-interfaces",level:2},{value:"Manejar errores y respuestas de forma elegante",id:"manejar-errores-y-respuestas-de-forma-elegante",level:2},{value:"Manejo de APIs paginadas",id:"manejo-de-apis-paginadas",level:2},{value:"<strong>Par\xe1metros comunes de paginaci\xf3n:</strong>",id:"par\xe1metros-comunes-de-paginaci\xf3n",level:3},{value:"<strong>Estructura t\xedpica de respuesta paginada:</strong>",id:"estructura-t\xedpica-de-respuesta-paginada",level:2},{value:"Autenticaci\xf3n: proteger tus peticiones con OAuth y JWT",id:"autenticaci\xf3n-proteger-tus-peticiones-con-oauth-y-jwt",level:2},{value:"\xbfC\xf3mo funciona OAuth?",id:"c\xf3mo-funciona-oauth",level:2},{value:"1. <strong>Solicitud de Autorizaci\xf3n</strong>",id:"1-solicitud-de-autorizaci\xf3n",level:3},{value:"2. <strong>Usuario Autoriza</strong>",id:"2-usuario-autoriza",level:3},{value:"3. <strong>Intercambio por Token</strong>",id:"3-intercambio-por-token",level:3},{value:"4. <strong>Uso del Token</strong>",id:"4-uso-del-token",level:3},{value:"Ejemplo pr\xe1ctico simplificado:",id:"ejemplo-pr\xe1ctico-simplificado",level:2},{value:"\xbfPor qu\xe9 es seguro?",id:"por-qu\xe9-es-seguro",level:2},{value:"OAuth: inicio de sesi\xf3n con permisos",id:"oauth-inicio-de-sesi\xf3n-con-permisos",level:3},{value:"\xbfQu\xe9 es un JWT?",id:"qu\xe9-es-un-jwt",level:2},{value:"Estructura de un JWT:",id:"estructura-de-un-jwt",level:3},{value:"\xbfC\xf3mo funciona JWT?",id:"c\xf3mo-funciona-jwt",level:2},{value:"1. <strong>Generaci\xf3n del Token</strong> (Login exitoso)",id:"1-generaci\xf3n-del-token-login-exitoso",level:3},{value:"2. <strong>Env\xedo del Token</strong>",id:"2-env\xedo-del-token",level:3},{value:"3. <strong>Verificaci\xf3n del Token</strong>",id:"3-verificaci\xf3n-del-token",level:3},{value:"Ventajas de JWT:",id:"ventajas-de-jwt",level:2},{value:"Diferencias clave con OAuth:",id:"diferencias-clave-con-oauth",level:2},{value:"Ejemplo de token JWT decodificado:",id:"ejemplo-de-token-jwt-decodificado",level:2},{value:"JWT: un pase con firma digital",id:"jwt-un-pase-con-firma-digital",level:3},{value:"Diferencias clave entre frontend y backend",id:"diferencias-clave-entre-frontend-y-backend",level:2},{value:"En el frontend: mostrar datos en la interfaz",id:"en-el-frontend-mostrar-datos-en-la-interfaz",level:3},{value:"En el backend: combinar datos de otras APIs",id:"en-el-backend-combinar-datos-de-otras-apis",level:3},{value:"Manejo de CORS y variables de entorno",id:"manejo-de-cors-y-variables-de-entorno",level:2},{value:"Por qu\xe9 existe CORS",id:"por-qu\xe9-existe-cors",level:3},{value:"Qu\xe9 es un &quot;origen&quot;",id:"qu\xe9-es-un-origen",level:3},{value:"C\xf3mo responde CORS",id:"c\xf3mo-responde-cors",level:3},{value:"<strong>Preflight Request en CORS</strong>",id:"preflight-request-en-cors",level:2},{value:"<strong>\xbfQu\xe9 solicitudes requieren preflight?</strong>",id:"qu\xe9-solicitudes-requieren-preflight",level:3},{value:"<strong>\xbfQu\xe9 solicitudes NO requieren preflight?</strong>",id:"qu\xe9-solicitudes-no-requieren-preflight",level:3},{value:"Ejemplo en Node.js + Express",id:"ejemplo-en-nodejs--express",level:3},{value:"Ejemplo manual sin middleware",id:"ejemplo-manual-sin-middleware",level:3},{value:"Cu\xe1ndo te encuentras con CORS",id:"cu\xe1ndo-te-encuentras-con-cors",level:3},{value:"Resumen conceptual",id:"resumen-conceptual",level:3},{value:"Configuraci\xf3n de CORS en el backend",id:"configuraci\xf3n-de-cors-en-el-backend",level:3},{value:"Uso de variables de entorno",id:"uso-de-variables-de-entorno",level:3},{value:"Conclusi\xf3n: dominar las APIs es dominar el desarrollo moderno",id:"conclusi\xf3n-dominar-las-apis-es-dominar-el-desarrollo-moderno",level:2}];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"consumo-de-apis-web",children:"Consumo de APIs web"})}),"\n",(0,o.jsx)(n.p,{children:"Hoy en d\xeda, las aplicaciones ya no funcionan solas: necesitan hablar con otros servicios. Para lograrlo, usan APIs web. Aprender a consumir APIs es esencial si quieres crear apps modernas y conectadas. En este recorrido, veremos c\xf3mo hacer peticiones HTTP usando Fetch y Axios, c\xf3mo manejar errores, c\xf3mo proteger tus peticiones con OAuth y JWT, y c\xf3mo aplicar todo esto tanto en el frontend como en el backend."}),"\n",(0,o.jsx)(n.h2,{id:"hacer-peticiones-http-tu-primer-contacto-con-una-api",children:"Hacer peticiones HTTP: tu primer contacto con una API"}),"\n",(0,o.jsxs)(n.p,{children:["Cuando quieres pedir datos a una API (por ejemplo, una lista de libros), necesitas hacer una ",(0,o.jsx)(n.strong,{children:"petici\xf3n HTTP"}),". En JavaScript, puedes hacerlo de dos formas populares: usando ",(0,o.jsx)(n.strong,{children:"Fetch API"}),", que ya viene con el navegador, o ",(0,o.jsx)(n.strong,{children:"Axios"}),", una librer\xeda externa."]}),"\n",(0,o.jsx)(n.h3,{id:"usar-fetch-api",children:"Usar Fetch API"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"fetch()"})," es simple y directo. Haces una solicitud a una URL, esperas la respuesta y luego haces algo con los datos."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Ejemplo b\xe1sico con Fetch\nfetch("<https://api.example.com/data>")\n  .then((res) => {\n    // Verificar si la respuesta fue exitosa\n    if (!res.ok) throw new Error("Algo sali\xf3 mal");\n    // Convertir la respuesta a JSON\n    return res.json();\n  })\n  .then((data) => console.log(data))\n  .catch((error) => console.error("Error:", error));\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Si la petici\xf3n falla, el bloque ",(0,o.jsx)(n.code,{children:".catch()"})," atrapa el error y muestra un mensaje."]}),"\n",(0,o.jsx)(n.h3,{id:"usar-axios",children:"Usar Axios"}),"\n",(0,o.jsx)(n.p,{children:"Axios hace lo mismo, pero con algunas ventajas extra. Ya convierte todo a JSON autom\xe1ticamente y te da m\xe1s detalles si algo falla."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'import axios from "axios";\n\n// Ejemplo b\xe1sico con Axios\naxios\n  .get("<https://api.example.com/data>")\n  .then((res) => console.log(res.data))\n  .catch((error) => console.error("Error:", error));\n'})}),"\n",(0,o.jsx)(n.p,{children:"Tambi\xe9n puedes configurar Axios para que todas tus peticiones tengan el mismo encabezado, como un token de acceso:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Configuraci\xf3n global de Axios\naxios.defaults.headers.common["Authorization"] = "Bearer tu_token";\n'})}),"\n",(0,o.jsx)(n.h3,{id:"uso-moderno-con-asyncawait",children:"Uso moderno con async/await"}),"\n",(0,o.jsxs)(n.p,{children:["La forma m\xe1s moderna y legible de trabajar con peticiones as\xedncronas es usando ",(0,o.jsx)(n.code,{children:"async/await"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Ejemplo con async/await y Fetch\nasync function obtenerDatos() {\n  try {\n    const respuesta = await fetch("<https://api.example.com/data>");\n\n    // Verificar si la respuesta fue exitosa\n    if (!respuesta.ok) throw new Error("Error en la petici\xf3n");\n\n    // Convertir la respuesta a JSON\n    const datos = await respuesta.json();\n    return datos;\n  } catch (error) {\n    console.error("Fall\xf3:", error);\n    throw error; // Relanzar el error para que lo maneje quien llame a esta funci\xf3n\n  }\n}\n\n// Uso de la funci\xf3n\nasync function mostrarDatos() {\n  try {\n    const datos = await obtenerDatos();\n    console.log("Datos recibidos:", datos);\n  } catch (error) {\n    console.error("Error al mostrar datos:", error);\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"manejo-de-estados-de-carga-y-error-en-interfaces",children:"Manejo de estados de carga y error en interfaces"}),"\n",(0,o.jsx)(n.p,{children:"Cuando trabajas en el frontend, es importante mostrar estados de carga y manejar errores de forma elegante:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Ejemplo en un contexto de React, pero aplicable a cualquier framework\nconst [datos, setDatos] = useState(null);\nconst [cargando, setCargando] = useState(true);\nconst [error, setError] = useState(null);\n\nuseEffect(() => {\n  async function cargarDatos() {\n    try {\n      setCargando(true);\n      setError(null);\n\n      const respuesta = await fetch("<https://api.example.com/data>");\n\n      if (!respuesta.ok) {\n        throw new Error(`Error ${respuesta.status}: ${respuesta.statusText}`);\n      }\n\n      const datosRecibidos = await respuesta.json();\n      setDatos(datosRecibidos);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setCargando(false);\n    }\n  }\n\n  cargarDatos();\n}, []);\n\n// En la interfaz puedes usar estos estados:\nif (cargando) return <div>Cargando...</div>;\nif (error) return <div>Error: {error}</div>;\nif (!datos) return <div>No hay datos</div>;\n\nreturn <div>{/* Mostrar datos aqu\xed */}</div>;\n'})}),"\n",(0,o.jsx)(n.h2,{id:"manejar-errores-y-respuestas-de-forma-elegante",children:"Manejar errores y respuestas de forma elegante"}),"\n",(0,o.jsx)(n.p,{children:"Cuando haces peticiones, es vital no asumir que siempre saldr\xe1n bien. A veces el servidor responde con error, a veces la red falla, o a veces recibes una respuesta inesperada."}),"\n",(0,o.jsxs)(n.p,{children:["Con ",(0,o.jsx)(n.strong,{children:"Fetch"}),", necesitas comprobar manualmente si todo fue bien:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Manejo detallado de errores con Fetch\nfetch("<https://api.example.com/data>")\n  .then((response) => {\n    if (!response.ok) {\n      throw new Error(`HTTP error! status: ${response.status}`);\n    }\n    return response.json();\n  })\n  .then((data) => console.log(data))\n  .catch((error) => {\n    console.error("Error completo:", error);\n    // Puedes mostrar diferentes mensajes seg\xfan el tipo de error\n    if (error.name === "TypeError") {\n      console.error("Error de red - verifica tu conexi\xf3n");\n    } else {\n      console.error("Error del servidor:", error.message);\n    }\n  });\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Con ",(0,o.jsx)(n.strong,{children:"Axios"}),", puedes capturar detalles m\xe1s espec\xedficos:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'axios\n  .get("<https://api.example.com/data>")\n  .then((res) => console.log(res.data))\n  .catch((error) => {\n    if (error.response) {\n      // El servidor respondi\xf3 con un c\xf3digo de error\n      console.error("Respuesta del servidor:", error.response.status);\n      console.error("Datos del error:", error.response.data);\n    } else if (error.request) {\n      // La petici\xf3n fue hecha pero no se recibi\xf3 respuesta\n      console.error("No hubo respuesta del servidor");\n    } else {\n      // Algo pas\xf3 al configurar la petici\xf3n\n      console.error("Error general:", error.message);\n    }\n  });\n'})}),"\n",(0,o.jsx)(n.h2,{id:"manejo-de-apis-paginadas",children:"Manejo de APIs paginadas"}),"\n",(0,o.jsx)(n.p,{children:"Cuando una API devuelve muchos resultados (ej: 10,000 productos), en lugar de enviarlos todos de una vez, los divide en p\xe1ginas m\xe1s peque\xf1as (ej: 20 productos por p\xe1gina)."}),"\n",(0,o.jsx)(n.h3,{id:"par\xe1metros-comunes-de-paginaci\xf3n",children:(0,o.jsx)(n.strong,{children:"Par\xe1metros comunes de paginaci\xf3n:"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"page"}),": N\xfamero de p\xe1gina actual"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"limit"}),"\xa0o\xa0",(0,o.jsx)(n.strong,{children:"size"}),": Cantidad de elementos por p\xe1gina"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"offset"}),": N\xfamero de elementos a saltar"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"estructura-t\xedpica-de-respuesta-paginada",children:(0,o.jsx)(n.strong,{children:"Estructura t\xedpica de respuesta paginada:"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "data": [\n    { "id": 1, "nombre": "Producto A" },\n    { "id": 2, "nombre": "Producto B" }\n    // ... hasta \'limit\' elementos\n  ],\n  "pagination": {\n    "page": 1,\n    "limit": 20,\n    "totalItems": 150,\n    "totalPages": 8,\n    "hasNext": true,\n    "hasPrev": false\n  }\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Ejemplo de como manejar una API paginada:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Ejemplo de consumo de API paginada\nasync function obtenerDatosPaginados(pagina = 1, limite = 10) {\n  try {\n    const respuesta = await fetch(\n      `https://api.example.com/data?page=${pagina}&limit=${limite}`\n    );\n\n    if (!respuesta.ok) throw new Error("Error en la petici\xf3n");\n\n    const datos = await respuesta.json();\n\n    // Estructura t\xedpica de respuesta paginada\n    return {\n      datos: datos.items, // Los datos reales\n      paginaActual: datos.page, // P\xe1gina actual\n      totalPaginas: datos.totalPages, // Total de p\xe1ginas\n      totalElementos: datos.total, // Total de elementos\n      tieneSiguiente: datos.hasNext, // Si hay m\xe1s p\xe1ginas\n      tieneAnterior: datos.hasPrev, // Si hay p\xe1ginas anteriores\n    };\n  } catch (error) {\n    console.error("Error obteniendo datos paginados:", error);\n    throw error;\n  }\n}\n\n// Uso en una aplicaci\xf3n\nasync function cargarSiguientePagina() {\n  try {\n    const resultado = await obtenerDatosPaginados(paginaActual + 1);\n\n    // Actualizar estado de la aplicaci\xf3n\n    setDatos((prevDatos) => [...prevDatos, ...resultado.datos]);\n    setPaginaActual(resultado.paginaActual);\n    setTieneMasPaginas(resultado.tieneSiguiente);\n  } catch (error) {\n    console.error("Error cargando p\xe1gina:", error);\n  }\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["Hasta ahora hemos visto c\xf3mo consumir APIs p\xfablicas y manejar datos paginados, pero muchas APIs requieren ",(0,o.jsx)(n.strong,{children:"autenticaci\xf3n"})," para acceder a datos privados o realizar operaciones sensibles."]}),"\n",(0,o.jsxs)(n.p,{children:["Imagina que quieres acceder al perfil de un usuario en una red social, hacer una compra online, o gestionar tus archivos en la nube. Todas estas operaciones necesitan demostrar que eres quien dices ser. Aqu\xed es donde entran en juego dos herramientas fundamentales: ",(0,o.jsx)(n.strong,{children:"OAuth"})," para autorizaci\xf3n entre servicios y ",(0,o.jsx)(n.strong,{children:"JWT"})," para manejo seguro de identidad."]}),"\n",(0,o.jsx)(n.h2,{id:"autenticaci\xf3n-proteger-tus-peticiones-con-oauth-y-jwt",children:"Autenticaci\xf3n: proteger tus peticiones con OAuth y JWT"}),"\n",(0,o.jsxs)(n.p,{children:["Cuando accedes a datos privados, necesitas ",(0,o.jsx)(n.strong,{children:"demostrar qui\xe9n eres"}),". Aqu\xed entran dos herramientas clave: ",(0,o.jsx)(n.strong,{children:"OAuth"})," y ",(0,o.jsx)(n.strong,{children:"JWT"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"c\xf3mo-funciona-oauth",children:"\xbfC\xf3mo funciona OAuth?"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"OAuth (Open Authorization)"})," es un protocolo de autorizaci\xf3n est\xe1ndar que permite a las aplicaciones acceder a informaci\xf3n de usuarios en otros servicios sin necesidad de compartir sus contrase\xf1as."]}),"\n",(0,o.jsx)(n.p,{children:"El flujo b\xe1sico de OAuth 2.0 (la versi\xf3n m\xe1s usada) sigue estos pasos:"}),"\n",(0,o.jsxs)(n.h3,{id:"1-solicitud-de-autorizaci\xf3n",children:["1. ",(0,o.jsx)(n.strong,{children:"Solicitud de Autorizaci\xf3n"})]}),"\n",(0,o.jsx)(n.p,{children:"Tu aplicaci\xf3n redirige al usuario al proveedor de OAuth (como Google, GitHub, etc.) con:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Tu ",(0,o.jsx)(n.code,{children:"client_id"})," (identificador de tu aplicaci\xf3n)"]}),"\n",(0,o.jsxs)(n.li,{children:["Los ",(0,o.jsx)(n.code,{children:"scopes"})," (permisos que necesitas)"]}),"\n",(0,o.jsxs)(n.li,{children:["Una ",(0,o.jsx)(n.code,{children:"redirect_uri"})," (donde volver\xe1 despu\xe9s)"]}),"\n"]}),"\n",(0,o.jsxs)(n.h3,{id:"2-usuario-autoriza",children:["2. ",(0,o.jsx)(n.strong,{children:"Usuario Autoriza"})]}),"\n",(0,o.jsxs)(n.p,{children:['El usuario ve una pantalla del proveedor preguntando: "\xbfLa aplicaci\xf3n X quiere acceder a tu informaci\xf3n Y?" Si acepta, el proveedor redirige de vuelta a tu aplicaci\xf3n con un ',(0,o.jsx)(n.strong,{children:"c\xf3digo de autorizaci\xf3n"}),"."]}),"\n",(0,o.jsxs)(n.h3,{id:"3-intercambio-por-token",children:["3. ",(0,o.jsx)(n.strong,{children:"Intercambio por Token"})]}),"\n",(0,o.jsxs)(n.p,{children:["Tu aplicaci\xf3n backend intercambia ese c\xf3digo por un ",(0,o.jsx)(n.strong,{children:"token de acceso"}),", haciendo una petici\xf3n secreta (con tu ",(0,o.jsx)(n.code,{children:"client_secret"}),") al proveedor."]}),"\n",(0,o.jsxs)(n.h3,{id:"4-uso-del-token",children:["4. ",(0,o.jsx)(n.strong,{children:"Uso del Token"})]}),"\n",(0,o.jsx)(n.p,{children:"Con el token de acceso, tu aplicaci\xf3n puede hacer peticiones a la API del proveedor para obtener los datos autorizados."}),"\n",(0,o.jsx)(n.h2,{id:"ejemplo-pr\xe1ctico-simplificado",children:"Ejemplo pr\xe1ctico simplificado:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// 1. Usuario hace clic en "Login con Google"\nwindow.location.href = `https://accounts.google.com/o/oauth2/auth?\n  client_id=TU_CLIENT_ID&\n  redirect_uri=https://tuapp.com/callback&\n  scope=email profile&\n  response_type=code`;\n\n// 2. Google redirige a tu callback con un c\xf3digo\n// <https://tuapp.com/callback?code=AUTH_CODE>\n\n// 3. Backend intercambia c\xf3digo por token\nconst response = await fetch("<https://oauth2.googleapis.com/token>", {\n  method: "POST",\n  body: JSON.stringify({\n    code: "AUTH_CODE",\n    client_id: "TU_CLIENT_ID",\n    client_secret: "TU_CLIENT_SECRET",\n    redirect_uri: "<https://tuapp.com/callback>",\n    grant_type: "authorization_code",\n  }),\n});\n\n// 4. Obtienes el token de acceso\nconst { access_token } = await response.json();\n\n// 5. Usas el token para obtener datos del usuario\nconst userData = await fetch(\n  "<https://www.googleapis.com/oauth2/v2/userinfo>",\n  {\n    headers: { Authorization: `Bearer ${access_token}` },\n  }\n);\n'})}),"\n",(0,o.jsx)(n.h2,{id:"por-qu\xe9-es-seguro",children:"\xbfPor qu\xe9 es seguro?"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"No compartes contrase\xf1as"}),": El usuario nunca da su contrase\xf1a a tu aplicaci\xf3n"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Tokens temporales"}),": Los tokens expiran y se pueden revocar"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Permisos espec\xedficos"}),": Solo accedes a lo que el usuario autoriz\xf3 expl\xedcitamente"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"oauth-inicio-de-sesi\xf3n-con-permisos",children:"OAuth: inicio de sesi\xf3n con permisos"}),"\n",(0,o.jsx)(n.p,{children:"OAuth es como pedirle a Google permiso para acceder a tus datos sin darle tu contrase\xf1a a otra app. El proceso suele ir as\xed:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"El usuario inicia sesi\xf3n en un proveedor (como Google o GitHub)."}),"\n",(0,o.jsx)(n.li,{children:'Ese proveedor devuelve un "c\xf3digo de autorizaci\xf3n".'}),"\n",(0,o.jsxs)(n.li,{children:["Tu app cambia ese c\xf3digo por un ",(0,o.jsx)(n.strong,{children:"token de acceso"}),"."]}),"\n",(0,o.jsx)(n.li,{children:"Usas ese token para hacer peticiones protegidas."}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"En c\xf3digo, se ve as\xed:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Ejemplo de flujo OAuth en el backend con Node.js\nconst express = require("express");\nconst axios = require("axios");\nconst router = express.Router();\n\n// Ruta para intercambiar c\xf3digo por token de acceso\nrouter.post("/oauth/callback", async (req, res) => {\n  try {\n    const { code } = req.body;\n\n    // Intercambiar el c\xf3digo por un token de acceso\n    const tokenResponse = await axios.post(\n      "<https://oauth.example.com/token>",\n      {\n        code: code,\n        client_id: process.env.CLIENT_ID,\n        client_secret: process.env.CLIENT_SECRET,\n        grant_type: "authorization_code",\n        redirect_uri: process.env.REDIRECT_URI,\n      }\n    );\n\n    const { access_token, refresh_token } = tokenResponse.data;\n\n    // Usar el token para obtener datos del usuario\n    const userResponse = await axios.get("<https://api.example.com/user>", {\n      headers: { Authorization: `Bearer ${access_token}` },\n    });\n\n    // Guardar informaci\xf3n del usuario en la base de datos (ejemplo con SQLite)\n    const db = require("../data/database");\n    const stmt = db.prepare(`\n      INSERT OR REPLACE INTO users (id, email, access_token, refresh_token)\n      VALUES (?, ?, ?, ?)\n    `);\n\n    stmt.run([\n      userResponse.data.id,\n      userResponse.data.email,\n      access_token,\n      refresh_token,\n    ]);\n\n    res.json({\n      success: true,\n      user: userResponse.data,\n      access_token: access_token,\n    });\n  } catch (error) {\n    console.error("Error en OAuth callback:", error);\n    res.status(500).json({\n      success: false,\n      error: "Error en la autenticaci\xf3n",\n    });\n  }\n});\n\nmodule.exports = router;\n'})}),"\n",(0,o.jsx)(n.h2,{id:"qu\xe9-es-un-jwt",children:"\xbfQu\xe9 es un JWT?"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"JWT (JSON Web Token)"})," es un est\xe1ndar abierto que define una forma compacta y aut\xf3noma de transmitir informaci\xf3n de forma segura entre partes como un objeto JSON."]}),"\n",(0,o.jsx)(n.p,{children:'Un JWT es como un "pase de acceso" digital que contiene informaci\xf3n sobre el usuario. Est\xe1 formado por tres partes separadas por puntos:'}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"header.payload.signature\n\n"})}),"\n",(0,o.jsx)(n.h3,{id:"estructura-de-un-jwt",children:"Estructura de un JWT:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Header"}),": Especifica el tipo de token y el algoritmo de firma"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Payload"}),': Contiene los "claims" o datos del usuario (id, nombre, permisos, expiraci\xf3n)']}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Signature"}),": Firma digital que verifica la autenticidad del token"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"c\xf3mo-funciona-jwt",children:"\xbfC\xf3mo funciona JWT?"}),"\n",(0,o.jsxs)(n.h3,{id:"1-generaci\xf3n-del-token-login-exitoso",children:["1. ",(0,o.jsx)(n.strong,{children:"Generaci\xf3n del Token"})," (Login exitoso)"]}),"\n",(0,o.jsx)(n.p,{children:"Cuando un usuario inicia sesi\xf3n correctamente, el servidor genera un JWT:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Backend - Generar JWT tras login exitoso\nconst jwt = require("jsonwebtoken");\n\nfunction generarToken(usuario) {\n  const payload = {\n    id: usuario.id,\n    email: usuario.email,\n    exp: Math.floor(Date.now() / 1000) + 60 * 60, // Expira en 1 hora\n  };\n\n  return jwt.sign(payload, "clave_secreta", { algorithm: "HS256" });\n}\n\n// Usuario se logea correctamente\napp.post("/login", (req, res) => {\n  const { email, password } = req.body;\n\n  // Verificar credenciales (ejemplo simplificado)\n  const usuario = verificarCredenciales(email, password);\n\n  if (usuario) {\n    const token = generarToken(usuario);\n    res.json({\n      token: token,\n      usuario: { id: usuario.id, email: usuario.email },\n    });\n  } else {\n    res.status(401).json({ error: "Credenciales inv\xe1lidas" });\n  }\n});\n'})}),"\n",(0,o.jsxs)(n.h3,{id:"2-env\xedo-del-token",children:["2. ",(0,o.jsx)(n.strong,{children:"Env\xedo del Token"})]}),"\n",(0,o.jsx)(n.p,{children:"El cliente guarda el JWT (normalmente en localStorage o cookies) y lo env\xeda en cada petici\xf3n:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Frontend - Enviar JWT en peticiones\nconst token = localStorage.getItem("jwt_token");\n\nfetch("/api/datos-protegidos", {\n  headers: {\n    Authorization: `Bearer ${token}`,\n    "Content-Type": "application/json",\n  },\n});\n'})}),"\n",(0,o.jsxs)(n.h3,{id:"3-verificaci\xf3n-del-token",children:["3. ",(0,o.jsx)(n.strong,{children:"Verificaci\xf3n del Token"})]}),"\n",(0,o.jsx)(n.p,{children:"El servidor verifica la validez del JWT en cada petici\xf3n protegida:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Backend - Middleware de verificaci\xf3n\nfunction verificarToken(req, res, next) {\n  const authHeader = req.headers["authorization"];\n  const token = authHeader && authHeader.split(" ")[1]; // "Bearer TOKEN"\n\n  if (!token) {\n    return res.status(401).json({ error: "Token requerido" });\n  }\n\n  jwt.verify(token, "clave_secreta", (err, usuario) => {\n    if (err) {\n      return res.status(403).json({ error: "Token inv\xe1lido o expirado" });\n    }\n\n    req.usuario = usuario; // Informaci\xf3n del usuario decodificada\n    next();\n  });\n}\n\n// Uso en rutas protegidas\napp.get("/api/perfil", verificarToken, (req, res) => {\n  // req.usuario contiene los datos del JWT (id, email, etc.)\n  res.json({\n    mensaje: "Acceso permitido",\n    usuario: req.usuario,\n  });\n});\n'})}),"\n",(0,o.jsx)(n.h2,{id:"ventajas-de-jwt",children:"Ventajas de JWT:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Sin estado (stateless)"}),": El servidor no necesita guardar sesiones"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Portable"}),": La informaci\xf3n del usuario viaja en el propio token"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Verificaci\xf3n r\xe1pida"}),": Solo necesita verificar la firma digital"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Escalable"}),": Ideal para arquitecturas de microservicios"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"diferencias-clave-con-oauth",children:"Diferencias clave con OAuth:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"OAuth"}),": Protocolo de autorizaci\xf3n para acceder a recursos de terceros"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"JWT"}),": Formato de token que puede usarse dentro de OAuth u otros sistemas"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"ejemplo-de-token-jwt-decodificado",children:"Ejemplo de token JWT decodificado:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Header\n{\n  "alg": "HS256",\n  "typ": "JWT"\n}\n\n// Payload\n{\n  "id": 123,\n  "email": "usuario@ejemplo.com",\n  "iat": 1516239022,  // Fecha de emisi\xf3n\n  "exp": 1516242622   // Fecha de expiraci\xf3n\n}\n\n// Signature (firmado con clave secreta)\nHMACSHA256(base64UrlEncode(header) + "." + base64UrlEncode(payload), secreto)\n\n'})}),"\n",(0,o.jsx)(n.h3,{id:"jwt-un-pase-con-firma-digital",children:"JWT: un pase con firma digital"}),"\n",(0,o.jsx)(n.p,{children:"JWT (JSON Web Token) es un archivo que contiene datos sobre el usuario, firmado digitalmente. Si tienes un JWT v\xe1lido, puedes acceder a recursos protegidos."}),"\n",(0,o.jsx)(n.p,{children:"Tu flujo ser\xeda as\xed:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"El usuario inicia sesi\xf3n \u2192 el servidor genera un JWT."}),"\n",(0,o.jsx)(n.li,{children:"El cliente guarda el JWT (en localStorage, por ejemplo)."}),"\n",(0,o.jsx)(n.li,{children:"Para cada petici\xf3n, el cliente env\xeda el JWT en los encabezados."}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// En el frontend - enviar JWT en las peticiones\nasync function hacerPeticionProtegida() {\n  const token = localStorage.getItem("jwt_token");\n\n  if (!token) {\n    // Redirigir al login si no hay token\n    window.location.href = "/login";\n    return;\n  }\n\n  try {\n    const respuesta = await fetch("<https://api.example.com/protegido>", {\n      headers: {\n        Authorization: `Bearer ${token}`,\n        "Content-Type": "application/json",\n      },\n    });\n\n    if (respuesta.status === 401) {\n      // Token expirado o inv\xe1lido\n      localStorage.removeItem("jwt_token");\n      window.location.href = "/login";\n      return;\n    }\n\n    if (!respuesta.ok) throw new Error("Error en la petici\xf3n");\n\n    const datos = await respuesta.json();\n    return datos;\n  } catch (error) {\n    console.error("Error en petici\xf3n protegida:", error);\n    throw error;\n  }\n}\n\n// En el backend - verificar JWT\nconst jwt = require("jsonwebtoken");\n\nfunction autenticarToken(req, res, next) {\n  const authHeader = req.headers["authorization"];\n  const token = authHeader && authHeader.split(" ")[1]; // Formato: "Bearer TOKEN"\n\n  if (!token) {\n    return res.status(401).json({ error: "Token de acceso requerido" });\n  }\n\n  jwt.verify(token, process.env.JWT_SECRET, (err, usuario) => {\n    if (err) {\n      return res.status(403).json({ error: "Token inv\xe1lido o expirado" });\n    }\n\n    req.usuario = usuario;\n    next();\n  });\n}\n\n// Uso en las rutas protegidas\napp.get("/api/datos-protegidos", autenticarToken, (req, res) => {\n  // Solo usuarios autenticados llegan aqu\xed\n  res.json({\n    mensaje: "Datos protegidos",\n    usuario: req.usuario,\n  });\n});\n'})}),"\n",(0,o.jsx)(n.h2,{id:"diferencias-clave-entre-frontend-y-backend",children:"Diferencias clave entre frontend y backend"}),"\n",(0,o.jsx)(n.h3,{id:"en-el-frontend-mostrar-datos-en-la-interfaz",children:"En el frontend: mostrar datos en la interfaz"}),"\n",(0,o.jsxs)(n.p,{children:["Imagina que tienes una app en React que quiere mostrar datos al cargar. Puedes usar ",(0,o.jsx)(n.code,{children:"fetch()"})," en un ",(0,o.jsx)(n.code,{children:"useEffect"})," para pedir esos datos y mostrarlos:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Frontend - React example\nimport { useState, useEffect } from "react";\n\nfunction ListaDeProductos() {\n  const [productos, setProductos] = useState([]);\n  const [cargando, setCargando] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    async function cargarProductos() {\n      try {\n        setCargando(true);\n        const respuesta = await fetch("/api/productos");\n\n        if (!respuesta.ok) {\n          throw new Error(`Error ${respuesta.status}`);\n        }\n\n        const datos = await respuesta.json();\n        setProductos(datos);\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setCargando(false);\n      }\n    }\n\n    cargarProductos();\n  }, []);\n\n  if (cargando) return <div>Cargando productos...</div>;\n  if (error) return <div>Error: {error}</div>;\n\n  return (\n    <div>\n      <h2>Productos Disponibles</h2>\n      <ul>\n        {productos.map((producto) => (\n          <li key={producto.id}>\n            {producto.nombre} - ${producto.precio}\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n'})}),"\n",(0,o.jsx)(n.h3,{id:"en-el-backend-combinar-datos-de-otras-apis",children:"En el backend: combinar datos de otras APIs"}),"\n",(0,o.jsx)(n.p,{children:"A veces, tu servidor (por ejemplo, una app en Node.js) tambi\xe9n necesita hablar con otras APIs, como una pasarela de pagos o un servicio externo."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Backend - Node.js + Express consumiendo otra API\nconst express = require("express");\nconst axios = require("axios");\nconst router = express.Router();\n\n// Ruta que consume datos de una API externa y los procesa\nrouter.get("/datos-combinados", async (req, res) => {\n  try {\n    // Hacer m\xfaltiples peticiones en paralelo\n    const [usuariosResponse, productosResponse] = await Promise.all([\n      axios.get("<https://api.users.com/usuarios>"),\n      axios.get("<https://api.products.com/productos>"),\n    ]);\n\n    // Combinar y procesar datos\n    const datosCombinados = {\n      usuarios: usuariosResponse.data,\n      productos: productosResponse.data,\n      timestamp: new Date().toISOString(),\n      totalElementos:\n        usuariosResponse.data.length + productosResponse.data.length,\n    };\n\n    // Opcional: guardar en base de datos SQLite\n    const db = require("../data/database");\n    db.run("INSERT INTO cache_api (tipo, datos) VALUES (?, ?)", [\n      "datos_combinados",\n      JSON.stringify(datosCombinados),\n    ]);\n\n    res.json(datosCombinados);\n  } catch (error) {\n    console.error("Error obteniendo datos combinados:", error);\n\n    // En caso de error, intentar servir datos cacheados\n    const db = require("../data/database");\n    db.get(\n      "SELECT datos FROM cache_api WHERE tipo = ? ORDER BY fecha DESC LIMIT 1",\n      ["datos_combinados"],\n      (err, row) => {\n        if (err || !row) {\n          return res.status(500).json({\n            error: "No se pudieron obtener los datos",\n          });\n        }\n\n        res.json(JSON.parse(row.datos));\n      }\n    );\n  }\n});\n\nmodule.exports = router;\n'})}),"\n",(0,o.jsx)(n.h2,{id:"manejo-de-cors-y-variables-de-entorno",children:"Manejo de CORS y variables de entorno"}),"\n",(0,o.jsxs)(n.p,{children:["CORS significa ",(0,o.jsx)(n.strong,{children:"Cross-Origin Resource Sharing"})," o ",(0,o.jsx)(n.strong,{children:"Compartici\xf3n de Recursos entre Or\xedgenes"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["Es un ",(0,o.jsx)(n.strong,{children:"mecanismo de seguridad del navegador"})," que controla qu\xe9 sitios web pueden hacer peticiones a un servidor distinto del dominio desde el que fue cargada la p\xe1gina."]}),"\n",(0,o.jsx)(n.h3,{id:"por-qu\xe9-existe-cors",children:"Por qu\xe9 existe CORS"}),"\n",(0,o.jsx)(n.p,{children:"Sin CORS, cualquier p\xe1gina maliciosa podr\xeda cargar tu web en segundo plano y hacer peticiones a tu API usando tus credenciales, robando o manipulando datos. CORS evita eso al exigir que el servidor autorice expl\xedcitamente qu\xe9 or\xedgenes externos pueden comunicarse con \xe9l."}),"\n",(0,o.jsx)(n.h3,{id:"qu\xe9-es-un-origen",children:'Qu\xe9 es un "origen"'}),"\n",(0,o.jsx)(n.p,{children:"El origen se define por tres elementos:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Protocolo (http / https)"}),"\n",(0,o.jsx)(n.li,{children:"Dominio (ejemplo.com)"}),"\n",(0,o.jsx)(n.li,{children:"Puerto (:3000, :8080, etc.)"}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Ejemplo:"}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"URL"}),(0,o.jsx)(n.th,{children:"Origen"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.a,{href:"https://miapp.com/",children:"https://miapp.com"})}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.a,{href:"https://miapp.com/",children:"https://miapp.com"})})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.a,{href:"https://api.miapp.com/",children:"https://api.miapp.com"})}),(0,o.jsx)(n.td,{children:"Es otro origen"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.a,{href:"http://localhost:3000/",children:"http://localhost:3000"})}),(0,o.jsxs)(n.td,{children:["Diferente origen de ",(0,o.jsx)(n.a,{href:"https://miapp.com/",children:"https://miapp.com"})]})]})]})]}),"\n",(0,o.jsxs)(n.p,{children:["Si tu frontend est\xe1 en ",(0,o.jsx)(n.code,{children:"http://localhost:5173"})," y la API en ",(0,o.jsx)(n.code,{children:"http://localhost:3000"}),", el navegador las considera ",(0,o.jsx)(n.strong,{children:"or\xedgenes distintos"}),", y CORS entra en juego."]}),"\n",(0,o.jsx)(n.h3,{id:"c\xf3mo-responde-cors",children:"C\xf3mo responde CORS"}),"\n",(0,o.jsxs)(n.p,{children:["Cuando el navegador detecta que la petici\xf3n es a otro origen, primero env\xeda una petici\xf3n de verificaci\xf3n (preflight) con ",(0,o.jsx)(n.code,{children:"OPTIONS"}),". El servidor debe responder indicando si se permite el acceso."]}),"\n",(0,o.jsx)(n.p,{children:"Las cabeceras m\xe1s usadas son:"}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"Cabecera"}),(0,o.jsx)(n.th,{children:"Qu\xe9 indica"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"Access-Control-Allow-Origin"})}),(0,o.jsx)(n.td,{children:"Or\xedgenes permitidos"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"Access-Control-Allow-Methods"})}),(0,o.jsx)(n.td,{children:"M\xe9todos permitidos (GET, POST, etc.)"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"Access-Control-Allow-Headers"})}),(0,o.jsx)(n.td,{children:"Qu\xe9 cabeceras puede enviar el cliente"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"Access-Control-Allow-Credentials"})}),(0,o.jsx)(n.td,{children:"Si se permiten cookies/tokens enviadas por el navegador"})]})]})]}),"\n",(0,o.jsx)(n.h2,{id:"preflight-request-en-cors",children:(0,o.jsx)(n.strong,{children:"Preflight Request en CORS"})}),"\n",(0,o.jsxs)(n.p,{children:['Cuando el navegador detecta una petici\xf3n "compleja" (con ciertos headers personalizados, m\xe9todos diferentes a GET/POST/HEAD, o contenido con tipo espec\xedfico), aplica un mecanismo de seguridad adicional llamado ',(0,o.jsx)(n.strong,{children:"preflight"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["El navegador env\xeda primero una petici\xf3n ",(0,o.jsx)(n.code,{children:"OPTIONS"})," para verificar si el servidor permite la operaci\xf3n real:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:"// Petici\xf3n PREFLIGHT que env\xeda el navegador autom\xe1ticamente:\nOPTIONS /api/datos-protegidos HTTP/1.1\nOrigin: <https://mi-frontend.com>\nAccess-Control-Request-Method: DELETE\nAccess-Control-Request-Headers: Authorization, Content-Type\n"})}),"\n",(0,o.jsx)(n.p,{children:"El servidor debe responder autorizando estas operaciones:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:"// Respuesta del servidor a la preflight:\nHTTP/1.1 204 No Content\nAccess-Control-Allow-Origin: https://mi-frontend.com\nAccess-Control-Allow-Methods: GET, POST, PUT, DELETE, OPTIONS\nAccess-Control-Allow-Headers: Authorization, Content-Type\nAccess-Control-Allow-Credentials: true\nAccess-Control-Max-Age: 86400  // Cachear esta respuesta por 24 horas\n"})}),"\n",(0,o.jsx)(n.p,{children:"Solo despu\xe9s de recibir esta autorizaci\xf3n, el navegador env\xeda la petici\xf3n real con los datos."}),"\n",(0,o.jsx)(n.h3,{id:"qu\xe9-solicitudes-requieren-preflight",children:(0,o.jsx)(n.strong,{children:"\xbfQu\xe9 solicitudes requieren preflight?"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"M\xe9todos: PUT, DELETE, PATCH, etc."}),"\n",(0,o.jsx)(n.li,{children:"Headers personalizados: Authorization, X-API-Key, etc."}),"\n",(0,o.jsx)(n.li,{children:"Content-Type diferente a: application/x-www-form-urlencoded, multipart/form-data, text/plain"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"qu\xe9-solicitudes-no-requieren-preflight",children:(0,o.jsx)(n.strong,{children:"\xbfQu\xe9 solicitudes NO requieren preflight?"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"GET, POST, HEAD con Content-Type est\xe1ndar"}),"\n",(0,o.jsx)(n.li,{children:"Peticiones simples sin headers personalizados"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"ejemplo-en-nodejs--express",children:"Ejemplo en Node.js + Express"}),"\n",(0,o.jsxs)(n.p,{children:["Si tu API est\xe1 en ",(0,o.jsx)(n.code,{children:"http://localhost:3000"})," y tu frontend en ",(0,o.jsx)(n.code,{children:"http://localhost:5173"}),", instala el middleware CORS:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"npm install cors\n\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Luego en ",(0,o.jsx)(n.code,{children:"server.js"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'const express = require("express");\nconst cors = require("cors");\nconst app = express();\n\napp.use(\n  cors({\n    origin: "http://localhost:5173",\n    credentials: true, // si usas cookies o sesiones\n  })\n);\n\napp.get("/api/data", (req, res) => {\n  res.json({ msg: "API funcionando y CORS habilitado" });\n});\n\napp.listen(3000);\n'})}),"\n",(0,o.jsx)(n.h3,{id:"ejemplo-manual-sin-middleware",children:"Ejemplo manual sin middleware"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'app.use((req, res, next) => {\n  res.header("Access-Control-Allow-Origin", "http://localhost:5173");\n  res.header("Access-Control-Allow-Methods", "GET,POST,PUT,DELETE");\n  res.header("Access-Control-Allow-Headers", "Content-Type, Authorization");\n  next();\n});\n'})}),"\n",(0,o.jsx)(n.h3,{id:"cu\xe1ndo-te-encuentras-con-cors",children:"Cu\xe1ndo te encuentras con CORS"}),"\n",(0,o.jsx)(n.p,{children:"Situaciones t\xedpicas:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Frontend en React/Vite/Angular/Vue consumiendo API Express"}),"\n",(0,o.jsx)(n.li,{children:"Aplicaci\xf3n local pidiendo datos a API remota"}),"\n",(0,o.jsx)(n.li,{children:"SPA usando cookies de sesi\xf3n"}),"\n",(0,o.jsx)(n.li,{children:"APIs p\xfablicas que solo permiten ciertos dominios"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"resumen-conceptual",children:"Resumen conceptual"}),"\n",(0,o.jsx)(n.p,{children:"CORS no es un error de tu c\xf3digo"}),"\n",(0,o.jsxs)(n.p,{children:["El error t\xedpico \u201cBlocked by CORS policy\u201d no significa que tu c\xf3digo est\xe9 mal, sino que ",(0,o.jsx)(n.strong,{children:"el servidor no est\xe1 diciendo expl\xedcitamente que permite tu origen"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"En otras palabras:"}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:"El navegador bloquea para protegerte, y el servidor debe autorizar."}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"configuraci\xf3n-de-cors-en-el-backend",children:"Configuraci\xf3n de CORS en el backend"}),"\n",(0,o.jsx)(n.p,{children:"Cuando el frontend consume APIs externas o de diferente dominio, necesitas configurar CORS:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:'// Backend - Configuraci\xf3n de CORS\nconst express = require("express");\nconst cors = require("cors");\n\nconst app = express();\n\n// Configuraci\xf3n b\xe1sica de CORS\napp.use(\n  cors({\n    origin: process.env.FRONTEND_URL || "<http://localhost:3000>",\n    methods: ["GET", "POST", "PUT", "DELETE"],\n    allowedHeaders: ["Content-Type", "Authorization"],\n    credentials: true, // Si usas cookies o autenticaci\xf3n con sesiones\n  })\n);\n\n// O configurar manualmente los headers CORS\napp.use((req, res, next) => {\n  res.header("Access-Control-Allow-Origin", process.env.FRONTEND_URL || "*");\n  res.header("Access-Control-Allow-Methods", "GET, POST, PUT, DELETE, OPTIONS");\n  res.header("Access-Control-Allow-Headers", "Content-Type, Authorization");\n\n  if (req.method === "OPTIONS") {\n    return res.sendStatus(200);\n  }\n\n  next();\n});\n'})}),"\n",(0,o.jsx)(n.h3,{id:"uso-de-variables-de-entorno",children:"Uso de variables de entorno"}),"\n",(0,o.jsx)(n.p,{children:"Es crucial usar variables de entorno para configuraciones sensibles:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-jsx",children:"// .env file\nAPI_BASE_URL=https://api.ejemplo.com\nJWT_SECRET=tu_clave_secreta_muy_segura\nCLIENT_ID=tu_client_id\nCLIENT_SECRET=tu_client_secret\nDATABASE_PATH=./data/mi_app.db\n\n// En tu c\xf3digo\nrequire('dotenv').config();\n\nconst config = {\n  apiBaseUrl: process.env.API_BASE_URL,\n  jwtSecret: process.env.JWT_SECRET,\n  clientId: process.env.CLIENT_ID,\n  clientSecret: process.env.CLIENT_SECRET,\n  databasePath: process.env.DATABASE_PATH\n};\n\n// Uso en peticiones\nasync function hacerPeticionExterna() {\n  const respuesta = await fetch(`${process.env.API_BASE_URL}/datos`, {\n    headers: {\n      'Client-ID': process.env.CLIENT_ID,\n      'Authorization': `Bearer ${process.env.API_KEY}`\n    }\n  });\n\n  return await respuesta.json();\n}\n\n"})}),"\n",(0,o.jsx)(n.h2,{id:"conclusi\xf3n-dominar-las-apis-es-dominar-el-desarrollo-moderno",children:"Conclusi\xf3n: dominar las APIs es dominar el desarrollo moderno"}),"\n",(0,o.jsx)(n.p,{children:"Consumir APIs no es solo hacer peticiones: es entender c\xf3mo hablar con otros sistemas, manejar errores de forma inteligente y mantener la seguridad en todo momento. Ya sea desde el navegador o desde tu servidor, saber usar Fetch, Axios, JWT y OAuth te da una ventaja enorme como desarrollador."})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>t});var s=r(6540);const o={},a=s.createContext(o);function i(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);