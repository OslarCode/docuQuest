"use strict";(globalThis.webpackChunkDocuQuest_oslar_code=globalThis.webpackChunkDocuQuest_oslar_code||[]).push([[1936],{8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>d});var i=s(6540);const a={},l=i.createContext(a);function c(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),i.createElement(l.Provider,{value:n},e.children)}},9255:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"backend/databases/Planificacion_conceptual_de_consultas","title":"Planificaci\xf3n conceptual de consultas","description":"19.1. Qu\xe9 es la planificaci\xf3n de consultas","source":"@site/docs/backend/databases/Planificacion_conceptual_de_consultas.md","sourceDirName":"backend/databases","slug":"/backend/databases/Planificacion_conceptual_de_consultas","permalink":"/docuQuest/docs/backend/databases/Planificacion_conceptual_de_consultas","draft":false,"unlisted":false,"editUrl":"https://github.com/OslarCode/OslarCode/docs/backend/databases/Planificacion_conceptual_de_consultas.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Patrones de indexaci\xf3n","permalink":"/docuQuest/docs/backend/databases/Patrones_de_indexacion"},"next":{"title":"ACID sin humo","permalink":"/docuQuest/docs/backend/databases/ACID_sin_humo"}}');var a=s(4848),l=s(8453);const c={},d="Planificaci\xf3n conceptual de consultas",r={},o=[{value:"19.1. Qu\xe9 es la planificaci\xf3n de consultas",id:"191-qu\xe9-es-la-planificaci\xf3n-de-consultas",level:2},{value:"19.2. Full Table Scan vs Index Scan",id:"192-full-table-scan-vs-index-scan",level:2},{value:"19.3. Cardinalidad y selectividad: el n\xfacleo de la decisi\xf3n",id:"193-cardinalidad-y-selectividad-el-n\xfacleo-de-la-decisi\xf3n",level:2},{value:"19.4. Costos estimados y reales",id:"194-costos-estimados-y-reales",level:2},{value:"19.5. C\xf3mo influir en el plan sin \u201cforzar\u201d nada",id:"195-c\xf3mo-influir-en-el-plan-sin-forzar-nada",level:2},{value:"19.6. Planificaci\xf3n en consultas con JOIN",id:"196-planificaci\xf3n-en-consultas-con-join",level:2},{value:"19.7. Tipos comunes de join y cu\xe1ndo se eligen",id:"197-tipos-comunes-de-join-y-cu\xe1ndo-se-eligen",level:2},{value:"19.8. Ordenaci\xf3n y planificaci\xf3n",id:"198-ordenaci\xf3n-y-planificaci\xf3n",level:2},{value:"19.9. Agrupaciones (<code>GROUP BY</code>) y planificaci\xf3n",id:"199-agrupaciones-group-by-y-planificaci\xf3n",level:2},{value:"19.10. Subconsultas vs joins: impacto en el plan",id:"1910-subconsultas-vs-joins-impacto-en-el-plan",level:2},{value:"19.11. Paginaci\xf3n y planificaci\xf3n",id:"1911-paginaci\xf3n-y-planificaci\xf3n",level:2},{value:"19.12. Estad\xedsticas actualizadas = planes m\xe1s inteligentes",id:"1912-estad\xedsticas-actualizadas--planes-m\xe1s-inteligentes",level:2},{value:"19.13. Buenas pr\xe1cticas de planificaci\xf3n conceptual",id:"1913-buenas-pr\xe1cticas-de-planificaci\xf3n-conceptual",level:2},{value:"19.14. Errores comunes",id:"1914-errores-comunes",level:2}];function t(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"planificaci\xf3n-conceptual-de-consultas",children:"Planificaci\xf3n conceptual de consultas"})}),"\n",(0,a.jsx)(n.h2,{id:"191-qu\xe9-es-la-planificaci\xf3n-de-consultas",children:"19.1. Qu\xe9 es la planificaci\xf3n de consultas"}),"\n",(0,a.jsxs)(n.p,{children:["Cuando lanzas una consulta SQL, el motor ",(0,a.jsx)(n.strong,{children:"no la ejecuta directamente"}),":"]}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"La analiza (parsing)."}),"\n",(0,a.jsxs)(n.li,{children:["La optimiza: elige ",(0,a.jsx)(n.em,{children:"c\xf3mo"})," obtener los datos."]}),"\n",(0,a.jsx)(n.li,{children:"La ejecuta."}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Este \u201c",(0,a.jsx)(n.em,{children:"c\xf3mo"}),"\u201d es lo que se llama ",(0,a.jsx)(n.strong,{children:"plan de ejecuci\xf3n"})," (",(0,a.jsx)(n.em,{children:"query plan"}),")."]}),"\n",(0,a.jsx)(n.p,{children:"Ejemplo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM cliente WHERE correo = 'ana@example.com';\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"El motor podr\xeda:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Recorrer toda la tabla (",(0,a.jsx)(n.code,{children:"Seq Scan"}),")."]}),"\n",(0,a.jsxs)(n.li,{children:["Usar un \xedndice en ",(0,a.jsx)(n.code,{children:"correo"})," (",(0,a.jsx)(n.code,{children:"Index Scan"}),")."]}),"\n",(0,a.jsx)(n.li,{children:"Combinarla con otras tablas (si hay JOIN)."}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["Entender ",(0,a.jsx)(n.strong,{children:"c\xf3mo piensa el optimizador"})," te permite ",(0,a.jsx)(n.strong,{children:"escribir consultas m\xe1s eficientes"}),", sin depender de trucos espec\xedficos de cada motor."]}),"\n",(0,a.jsx)(n.h2,{id:"192-full-table-scan-vs-index-scan",children:"19.2. Full Table Scan vs Index Scan"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Tipo de plan"}),(0,a.jsx)(n.th,{children:"Descripci\xf3n"}),(0,a.jsx)(n.th,{children:"Cu\xe1ndo ocurre"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Full Table Scan"})}),(0,a.jsx)(n.td,{children:"Recorre toda la tabla"}),(0,a.jsx)(n.td,{children:"No hay \xedndice \xfatil o pocos filtros selectivos"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Index Scan"})}),(0,a.jsx)(n.td,{children:"Usa un \xedndice para ubicar filas directamente"}),(0,a.jsx)(n.td,{children:"Hay \xedndice y el filtro es selectivo"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Bitmap Index Scan"})}),(0,a.jsx)(n.td,{children:"Combina varios \xedndices para filtrar"}),(0,a.jsx)(n.td,{children:"Filtros m\xfaltiples y no hay \xedndice compuesto directo"})]})]})]}),"\n",(0,a.jsx)(n.p,{children:"Ejemplo real:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"EXPLAIN\nSELECT * FROM cliente WHERE correo = 'ana@example.com';\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"Resultado posible:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Index Scan using idx_cliente_correo on cliente ...\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u2192 El motor eligi\xf3 el \xedndice porque ",(0,a.jsx)(n.strong,{children:"filtra bien"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"193-cardinalidad-y-selectividad-el-n\xfacleo-de-la-decisi\xf3n",children:"19.3. Cardinalidad y selectividad: el n\xfacleo de la decisi\xf3n"}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Cardinalidad:"})," n\xfamero de filas esperadas en el resultado."]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"Selectividad:"})," proporci\xf3n de filas que pasan el filtro."]}),"\n",(0,a.jsx)(n.p,{children:"Si la consulta devuelve el 0.001 % de las filas, usar un \xedndice es claramente mejor."}),"\n",(0,a.jsx)(n.p,{children:"Si devuelve el 80 %\u2026 un full scan puede ser m\xe1s barato que hacer millones de \u201csaltos de \xedndice\u201d."}),"\n",(0,a.jsx)(n.p,{children:"Regla pr\xe1ctica:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Alta selectividad \u2192 \xedndice."}),"\n",(0,a.jsx)(n.li,{children:"Baja selectividad \u2192 full scan suele ser m\xe1s eficiente."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Ejemplo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM pedido WHERE estado = 'pendiente';\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"Si solo 5 % de los pedidos est\xe1n pendientes \u2192 \xedndice es \xfatil."}),"\n",(0,a.jsx)(n.p,{children:"Si el 95 % est\xe1n pendientes \u2192 probablemente no lo usar\xe1."}),"\n",(0,a.jsx)(n.h2,{id:"194-costos-estimados-y-reales",children:"19.4. Costos estimados y reales"}),"\n",(0,a.jsxs)(n.p,{children:["Los optimizadores usan un ",(0,a.jsx)(n.strong,{children:"modelo de costos"}),":"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Lecturas de disco,"}),"\n",(0,a.jsx)(n.li,{children:"Saltos de \xedndice,"}),"\n",(0,a.jsx)(n.li,{children:"Combinaciones de tablas,"}),"\n",(0,a.jsx)(n.li,{children:"Coste estimado de filtrado."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Ejemplo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"EXPLAIN ANALYZE\nSELECT * FROM pedido WHERE estado = 'pendiente';\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"Salida t\xedpica:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"Seq Scan on pedido  (cost=0.00..1023.00 rows=500 width=32)\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u201ccost\u201d = estimaci\xf3n"}),"\n",(0,a.jsx)(n.p,{children:"\u201crows\u201d = cu\xe1ntas filas cree que saldr\xe1n"}),"\n",(0,a.jsx)(n.p,{children:"Si la estimaci\xf3n est\xe1 mal, el plan puede no ser el mejor."}),"\n",(0,a.jsx)(n.h2,{id:"195-c\xf3mo-influir-en-el-plan-sin-forzar-nada",children:"19.5. C\xf3mo influir en el plan sin \u201cforzar\u201d nada"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Dise\xf1ando bien \xedndices"})," (M17\u2013M18)."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Usando filtros claros y espec\xedficos"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Evitando funciones innecesarias sobre columnas indexadas"}),"."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Usando tipos correctos"})," (buscar ",(0,a.jsx)(n.code,{children:"fecha"})," en un campo ",(0,a.jsx)(n.code,{children:"DATE"})," y no en texto)."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Ejemplo malo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"WHERE LOWER(correo) = 'ana@example.com'\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["El \xedndice no se usa si fue creado sobre ",(0,a.jsx)(n.code,{children:"correo"})," sin LOWER."]}),"\n",(0,a.jsx)(n.p,{children:"Mejor:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Crear un \xedndice funcional sobre ",(0,a.jsx)(n.code,{children:"LOWER(correo)"})," si es necesario."]}),"\n",(0,a.jsx)(n.li,{children:"O guardar el correo normalizado."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"196-planificaci\xf3n-en-consultas-con-join",children:"19.6. Planificaci\xf3n en consultas con JOIN"}),"\n",(0,a.jsx)(n.p,{children:"Cuando haces joins, el optimizador debe decidir:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"En qu\xe9 orden"})," unir las tablas."]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"Qu\xe9 algoritmo usar"})," (nested loop, merge join, hash join\u2026)."]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Ejemplo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT *\nFROM pedido p\nJOIN cliente c ON p.id_cliente = c.id_cliente\nWHERE c.correo = 'ana@example.com';\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"Orden l\xf3gico:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Buscar cliente por correo (usa \xedndice en ",(0,a.jsx)(n.code,{children:"cliente.correo"}),")."]}),"\n",(0,a.jsxs)(n.li,{children:["Buscar sus pedidos (usa \xedndice en ",(0,a.jsx)(n.code,{children:"pedido.id_cliente"}),")."]}),"\n",(0,a.jsx)(n.li,{children:"Devolver resultados."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Si no hay \xedndices \u2192 escanea ambas tablas, genera un producto cartesiano parcial y luego filtra."}),"\n",(0,a.jsx)(n.p,{children:"Coste alt\xedsimo."}),"\n",(0,a.jsx)(n.h2,{id:"197-tipos-comunes-de-join-y-cu\xe1ndo-se-eligen",children:"19.7. Tipos comunes de join y cu\xe1ndo se eligen"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Tipo de join"}),(0,a.jsx)(n.th,{children:"C\xf3mo funciona"}),(0,a.jsx)(n.th,{children:"Cu\xe1ndo se usa normalmente"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Nested Loop"})}),(0,a.jsx)(n.td,{children:"Repite sobre cada fila de una tabla y busca en la otra (r\xe1pido con \xedndices)"}),(0,a.jsx)(n.td,{children:"1-a-N con \xedndices"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Merge Join"})}),(0,a.jsx)(n.td,{children:"Combina dos flujos ordenados"}),(0,a.jsx)(n.td,{children:"Tablas ordenadas, consultas grandes"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.strong,{children:"Hash Join"})}),(0,a.jsx)(n.td,{children:"Construye tabla hash y compara"}),(0,a.jsx)(n.td,{children:"Filtros amplios, sin \xedndice"})]})]})]}),"\n",(0,a.jsxs)(n.p,{children:["T\xfa no eliges directamente el algoritmo: ",(0,a.jsx)(n.strong,{children:"el optimizador lo hace seg\xfan el costo estimado"}),"."]}),"\n",(0,a.jsxs)(n.p,{children:["Pero puedes ",(0,a.jsx)(n.em,{children:"influir"})," en su decisi\xf3n ",(0,a.jsx)(n.strong,{children:"dando buena informaci\xf3n"})," (\xedndices, estad\xedsticas actualizadas, filtros claros)."]}),"\n",(0,a.jsx)(n.h2,{id:"198-ordenaci\xf3n-y-planificaci\xf3n",children:"19.8. Ordenaci\xf3n y planificaci\xf3n"}),"\n",(0,a.jsx)(n.p,{children:"Cuando haces:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM pedido ORDER BY fecha;\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u2192 Si tienes \xedndice en ",(0,a.jsx)(n.code,{children:"fecha"}),", el motor puede devolver filas ",(0,a.jsx)(n.strong,{children:"ya ordenadas"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"\u2192 Si no, debe ordenar en memoria o en disco (coste extra)."}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"La presencia de un \xedndice adecuado puede cambiar totalmente el plan"}),"."]}),"\n",(0,a.jsxs)(n.h2,{id:"199-agrupaciones-group-by-y-planificaci\xf3n",children:["19.9. Agrupaciones (",(0,a.jsx)(n.code,{children:"GROUP BY"}),") y planificaci\xf3n"]}),"\n",(0,a.jsxs)(n.p,{children:["Los \xedndices tambi\xe9n ayudan en ",(0,a.jsx)(n.code,{children:"GROUP BY"})," y agregaciones:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT estado, COUNT(*) FROM pedido GROUP BY estado;\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Si hay un \xedndice en ",(0,a.jsx)(n.code,{children:"estado"}),", el motor:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Puede recorrer filas ya agrupadas l\xf3gicamente,"}),"\n",(0,a.jsx)(n.li,{children:"Reduciendo operaciones de agrupaci\xf3n."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Si no, tendr\xe1 que escanear toda la tabla y agrupar desde cero."}),"\n",(0,a.jsxs)(n.p,{children:["Tambi\xe9n influye si hay pocas categor\xedas (",(0,a.jsx)(n.code,{children:"estado"}),") o muchas."]}),"\n",(0,a.jsx)(n.h2,{id:"1910-subconsultas-vs-joins-impacto-en-el-plan",children:"19.10. Subconsultas vs joins: impacto en el plan"}),"\n",(0,a.jsxs)(n.p,{children:["Dos consultas que devuelven lo mismo pueden generar ",(0,a.jsx)(n.strong,{children:"planes muy diferentes"}),":"]}),"\n",(0,a.jsx)(n.p,{children:"Subconsulta:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM pedido\nWHERE id_cliente IN (SELECT id_cliente FROM cliente WHERE ciudad = 'Madrid');\n\n"})}),"\n",(0,a.jsx)(n.p,{children:"Join equivalente:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT p.*\nFROM pedido p\nJOIN cliente c ON p.id_cliente = c.id_cliente\nWHERE c.ciudad = 'Madrid';\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Muchas veces el join produce ",(0,a.jsx)(n.strong,{children:"un plan m\xe1s eficiente"}),", porque permite:"]}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Optimizar el orden de acceso,"}),"\n",(0,a.jsx)(n.li,{children:"Reutilizar \xedndices,"}),"\n",(0,a.jsx)(n.li,{children:"Evitar subconsultas repetitivas."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.em,{children:"(aunque esto depende del motor \u2014 lo importante es razonar sobre el plan resultante)."})}),"\n",(0,a.jsx)(n.h2,{id:"1911-paginaci\xf3n-y-planificaci\xf3n",children:"19.11. Paginaci\xf3n y planificaci\xf3n"}),"\n",(0,a.jsxs)(n.p,{children:["Paginaciones grandes con ",(0,a.jsx)(n.code,{children:"OFFSET"})," generan planes costosos:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"SELECT * FROM pedido ORDER BY fecha LIMIT 10 OFFSET 50000;\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Aunque haya \xedndice, el motor debe ",(0,a.jsx)(n.strong,{children:"recorrer las 50.000 filas anteriores"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"El plan puede volverse muy caro."}),"\n",(0,a.jsx)(n.p,{children:"Patr\xf3n recomendado:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Paginaci\xf3n por cursor o marcador (como ya vimos en M18),"}),"\n",(0,a.jsx)(n.li,{children:"Reutilizar \xedndices ordenados."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"1912-estad\xedsticas-actualizadas--planes-m\xe1s-inteligentes",children:"19.12. Estad\xedsticas actualizadas = planes m\xe1s inteligentes"}),"\n",(0,a.jsxs)(n.p,{children:["El optimizador se basa en ",(0,a.jsx)(n.strong,{children:"estad\xedsticas internas"})," (n\xfamero de filas, distribuci\xf3n de valores)."]}),"\n",(0,a.jsx)(n.p,{children:"Si est\xe1n desactualizadas:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Har\xe1 malas estimaciones,"}),"\n",(0,a.jsx)(n.li,{children:"Elegir\xe1 planes sub\xf3ptimos,"}),"\n",(0,a.jsx)(n.li,{children:"Consultas lentas aunque haya \xedndices."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Soluci\xf3n:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"VACUUM ANALYZE;  -- PostgreSQL\nANALYZE TABLE pedido;  -- MySQL\n\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Siempre analiza tablas ",(0,a.jsx)(n.strong,{children:"despu\xe9s de cargas grandes o cambios estructurales"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"1913-buenas-pr\xe1cticas-de-planificaci\xf3n-conceptual",children:"19.13. Buenas pr\xe1cticas de planificaci\xf3n conceptual"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Dise\xf1a tus consultas pensando en ",(0,a.jsx)(n.strong,{children:"selectividad"}),", no en \u201clo que suena bien\u201d."]}),"\n",(0,a.jsx)(n.li,{children:"Usa \xedndices alineados con los patrones reales de acceso."}),"\n",(0,a.jsx)(n.li,{children:"Evita funciones que rompan el uso de \xedndices."}),"\n",(0,a.jsx)(n.li,{children:"Mant\xe9n estad\xedsticas actualizadas."}),"\n",(0,a.jsxs)(n.li,{children:["Usa ",(0,a.jsx)(n.code,{children:"EXPLAIN"})," y ",(0,a.jsx)(n.code,{children:"EXPLAIN ANALYZE"})," para entender qu\xe9 est\xe1 pasando."]}),"\n",(0,a.jsx)(n.li,{children:"Prefiere joins bien dise\xf1ados a subconsultas innecesarias."}),"\n",(0,a.jsx)(n.li,{children:"Ajusta consultas para evitar recorrer m\xe1s filas de las necesarias."}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"1914-errores-comunes",children:"19.14. Errores comunes"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Pensar que \u201csi hay \xedndice, siempre se usar\xe1\u201d."}),"\n",(0,a.jsx)(n.li,{children:"No revisar los planes de ejecuci\xf3n y confiar ciegamente."}),"\n",(0,a.jsx)(n.li,{children:"Escribir consultas que obligan a la base a hacer full scans innecesarios."}),"\n",(0,a.jsx)(n.li,{children:"Usar funciones o casting sobre columnas indexadas."}),"\n",(0,a.jsx)(n.li,{children:"No actualizar estad\xedsticas."}),"\n",(0,a.jsx)(n.li,{children:"Hacer paginaciones masivas con OFFSET sin pensar en el costo."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(t,{...e})}):t(e)}}}]);