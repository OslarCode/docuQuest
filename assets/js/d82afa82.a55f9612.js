"use strict";(globalThis.webpackChunkDocuQuest_oslar_code=globalThis.webpackChunkDocuQuest_oslar_code||[]).push([[2305],{2549:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>d,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"backend/databases/Modelo_de_privilegios_minimos","title":"Modelo de privilegios m\xednimos","description":"22.1. \xbfPor qu\xe9 hablar de seguridad a nivel de base de datos?","source":"@site/docs/backend/databases/Modelo_de_privilegios_minimos.md","sourceDirName":"backend/databases","slug":"/backend/databases/Modelo_de_privilegios_minimos","permalink":"/docuQuest/docs/backend/databases/Modelo_de_privilegios_minimos","draft":false,"unlisted":false,"editUrl":"https://github.com/OslarCode/OslarCode/docs/backend/databases/Modelo_de_privilegios_minimos.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Aislamiento y anomal\xedas","permalink":"/docuQuest/docs/backend/databases/Aislamiento_y_anomalias"},"next":{"title":"Datos sensibles y auditor\xeda","permalink":"/docuQuest/docs/backend/databases/Datos_sensibles_y_auditoria"}}');var r=n(4848),o=n(8453);const a={},d="Modelo de privilegios m\xednimos",l={},c=[{value:"22.1. \xbfPor qu\xe9 hablar de seguridad a nivel de base de datos?",id:"221-por-qu\xe9-hablar-de-seguridad-a-nivel-de-base-de-datos",level:2},{value:"22.2. Tipos de permisos m\xe1s comunes",id:"222-tipos-de-permisos-m\xe1s-comunes",level:2},{value:"22.3. Usuarios vs roles",id:"223-usuarios-vs-roles",level:2},{value:"22.4. Ejemplo pr\xe1ctico \u2014 escenario de tienda online",id:"224-ejemplo-pr\xe1ctico--escenario-de-tienda-online",level:2},{value:"22.5. Revocar permisos innecesarios",id:"225-revocar-permisos-innecesarios",level:2},{value:"22.6. Diferencia entre permisos de objeto y permisos globales",id:"226-diferencia-entre-permisos-de-objeto-y-permisos-globales",level:2},{value:"22.7. Seguridad en capas: vistas y funciones",id:"227-seguridad-en-capas-vistas-y-funciones",level:2},{value:"22.8. Buenas pr\xe1cticas con usuarios y roles",id:"228-buenas-pr\xe1cticas-con-usuarios-y-roles",level:2},{value:"22.9. Errores comunes",id:"229-errores-comunes",level:2}];function t(e){const s={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"modelo-de-privilegios-m\xednimos",children:"Modelo de privilegios m\xednimos"})}),"\n",(0,r.jsx)(s.h2,{id:"221-por-qu\xe9-hablar-de-seguridad-a-nivel-de-base-de-datos",children:"22.1. \xbfPor qu\xe9 hablar de seguridad a nivel de base de datos?"}),"\n",(0,r.jsxs)(s.p,{children:["Aunque muchas aplicaciones controlan permisos desde el backend, la ",(0,r.jsx)(s.strong,{children:"seguridad a nivel de base de datos es la \xfaltima l\xednea de defensa"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["Si alguien logra acceder a la base directamente, debe ",(0,r.jsx)(s.strong,{children:"encontrarse con barreras s\xf3lidas"}),"."]}),"\n",(0,r.jsx)(s.p,{children:"Ejemplo real:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Un atacante obtiene acceso a un usuario de lectura \u2192"}),"\n",(0,r.jsxs)(s.li,{children:["Si ese usuario tiene permisos de escritura, puede modificar o borrar informaci\xf3n.\nCon un ",(0,r.jsx)(s.strong,{children:"modelo de privilegios m\xednimo"}),", esto no ocurre."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Principio base:"}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsx)(s.p,{children:"\u201cCada usuario o servicio debe tener el m\xednimo permiso necesario para hacer su trabajo. Nada m\xe1s.\u201d"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"222-tipos-de-permisos-m\xe1s-comunes",children:"22.2. Tipos de permisos m\xe1s comunes"}),"\n",(0,r.jsx)(s.p,{children:"La mayor\xeda de motores SQL tienen permisos similares:"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Permiso"}),(0,r.jsx)(s.th,{children:"Qu\xe9 permite hacer"}),(0,r.jsx)(s.th,{children:"Ejemplo pr\xe1ctico"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"SELECT"})}),(0,r.jsx)(s.td,{children:"Leer datos"}),(0,r.jsx)(s.td,{children:"Ver registros de clientes."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"INSERT"})}),(0,r.jsx)(s.td,{children:"Insertar datos nuevos"}),(0,r.jsx)(s.td,{children:"Crear un pedido."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"UPDATE"})}),(0,r.jsx)(s.td,{children:"Modificar datos existentes"}),(0,r.jsx)(s.td,{children:"Cambiar estado de un pedido."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"DELETE"})}),(0,r.jsx)(s.td,{children:"Eliminar registros"}),(0,r.jsx)(s.td,{children:"Borrar un pedido cancelado."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsxs)(s.td,{children:[(0,r.jsx)(s.code,{children:"CREATE"})," / ",(0,r.jsx)(s.code,{children:"DROP"})]}),(0,r.jsx)(s.td,{children:"Crear o borrar tablas, esquemas\u2026"}),(0,r.jsx)(s.td,{children:"Administraci\xf3n de base."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"ALTER"})}),(0,r.jsx)(s.td,{children:"Modificar estructura"}),(0,r.jsx)(s.td,{children:"Cambiar columnas, tipos, \xedndices."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"EXECUTE"})}),(0,r.jsx)(s.td,{children:"Ejecutar procedimientos almacenados, funciones"}),(0,r.jsx)(s.td,{children:"Usado en sistemas con l\xf3gica en BD."})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:["A esto se suman permisos ",(0,r.jsx)(s.strong,{children:"a nivel de esquema"})," y ",(0,r.jsx)(s.strong,{children:"a nivel de objeto"})," (tabla, vista, funci\xf3n\u2026)."]}),"\n",(0,r.jsx)(s.h2,{id:"223-usuarios-vs-roles",children:"22.3. Usuarios vs roles"}),"\n",(0,r.jsx)(s.p,{children:"En sistemas bien dise\xf1ados:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Usuarios"})," representan personas o servicios concretos."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Roles"})," agrupan permisos comunes."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Esto permite escalar la gesti\xf3n de seguridad sin volverse locos."}),"\n",(0,r.jsx)(s.p,{children:"Ejemplo:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Rol ",(0,r.jsx)(s.code,{children:"LECTURA"})," \u2192 solo puede leer tablas."]}),"\n",(0,r.jsxs)(s.li,{children:["Rol ",(0,r.jsx)(s.code,{children:"BACKOFFICE"})," \u2192 puede leer y actualizar pedidos."]}),"\n",(0,r.jsxs)(s.li,{children:["Rol ",(0,r.jsx)(s.code,{children:"ADMIN"})," \u2192 puede modificar estructuras."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Luego simplemente asignas roles a usuarios:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"Usuario \u201cana\u201d \u2192 LECTURA\nUsuario \u201cjuan\u201d \u2192 BACKOFFICE\nUsuario \u201csoporte-api\u201d \u2192 LECTURA\n\n"})}),"\n",(0,r.jsx)(s.p,{children:"As\xed no necesitas definir permisos individuales para cada uno."}),"\n",(0,r.jsx)(s.h2,{id:"224-ejemplo-pr\xe1ctico--escenario-de-tienda-online",children:"22.4. Ejemplo pr\xe1ctico \u2014 escenario de tienda online"}),"\n",(0,r.jsx)(s.p,{children:"Supongamos una BD con tablas:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"producto"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"pedido"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"cliente"})}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Creamos roles:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"-- Rol solo lectura (por ejemplo para analistas)\nCREATE ROLE lector;\n\n-- Rol de gesti\xf3n (backoffice)\nCREATE ROLE gestor;\n\n-- Rol de administraci\xf3n total\nCREATE ROLE admin;\n\n"})}),"\n",(0,r.jsx)(s.p,{children:"Damos permisos:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"-- Solo lectura\nGRANT SELECT ON producto, pedido, cliente TO lector;\n\n-- Gesti\xf3n b\xe1sica (puede ver e insertar pedidos, no borrar productos)\nGRANT SELECT, INSERT, UPDATE ON pedido TO gestor;\nGRANT SELECT ON producto, cliente TO gestor;\n\n-- Administrador total\nGRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO admin;\n\n"})}),"\n",(0,r.jsx)(s.p,{children:"Creamos usuarios reales:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"CREATE USER ana PASSWORD '12345';\nCREATE USER juan PASSWORD '12345';\nCREATE USER servicio_api PASSWORD 'clave_segura';\n\nGRANT lector TO servicio_api;\nGRANT lector TO ana;\nGRANT gestor TO juan;\n\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"ana"})," y el servicio API solo pueden ",(0,r.jsx)(s.strong,{children:"leer datos"}),", no modificarlos."]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"juan"})," puede gestionar pedidos, pero no borrar tablas."]}),"\n",(0,r.jsxs)(s.p,{children:["Nadie que no tenga el rol ",(0,r.jsx)(s.code,{children:"admin"})," puede tocar la estructura."]}),"\n",(0,r.jsxs)(s.p,{children:["Esto es ",(0,r.jsx)(s.strong,{children:"principio de privilegios m\xednimos aplicado directamente"})," en la base."]}),"\n",(0,r.jsx)(s.h2,{id:"225-revocar-permisos-innecesarios",children:"22.5. Revocar permisos innecesarios"}),"\n",(0,r.jsxs)(s.p,{children:["Tan importante como dar permisos\u2026 es ",(0,r.jsx)(s.strong,{children:"quitarlos"}),"."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"REVOKE UPDATE ON producto FROM gestor;\n\n"})}),"\n",(0,r.jsxs)(s.p,{children:["Si ",(0,r.jsx)(s.code,{children:"gestor"})," no deber\xeda modificar productos, se le revoca."]}),"\n",(0,r.jsx)(s.p,{children:"Esto evita errores accidentales, y limita el da\xf1o en caso de cuentas comprometidas."}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.em,{children:"No asumas que \u201cno lo usar\xe1n\u201d \u2192 rev\xf3calo directamente."})}),"\n",(0,r.jsx)(s.h2,{id:"226-diferencia-entre-permisos-de-objeto-y-permisos-globales",children:"22.6. Diferencia entre permisos de objeto y permisos globales"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Permisos de objeto"})," \u2192 sobre tablas, vistas, funciones.\nEj: ",(0,r.jsx)(s.code,{children:"GRANT SELECT ON producto"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Permisos globales"})," \u2192 afectan al esquema entero o a la instancia.\nEj: ",(0,r.jsx)(s.code,{children:"GRANT CREATE ON DATABASE"}),"."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:"Regla general:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Da permisos ",(0,r.jsx)(s.strong,{children:"de objeto"})," siempre que sea posible."]}),"\n",(0,r.jsx)(s.li,{children:"Reserva permisos globales solo a administradores muy controlados."}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"227-seguridad-en-capas-vistas-y-funciones",children:"22.7. Seguridad en capas: vistas y funciones"}),"\n",(0,r.jsx)(s.p,{children:"Otra pr\xe1ctica com\xfan:"}),"\n",(0,r.jsx)(s.p,{children:"No dar acceso directo a tablas,"}),"\n",(0,r.jsxs)(s.p,{children:["Sino ",(0,r.jsx)(s.strong,{children:"dar acceso solo a vistas"})," que exponen la informaci\xf3n necesaria."]}),"\n",(0,r.jsx)(s.p,{children:"Ejemplo:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"CREATE VIEW vista_pedidos AS\nSELECT id_pedido, fecha, total FROM pedido WHERE estado != 'cancelado';\n\nGRANT SELECT ON vista_pedidos TO lector;\n\n"})}),"\n",(0,r.jsxs)(s.p,{children:["El rol ",(0,r.jsx)(s.code,{children:"lector"})," no tiene acceso a la tabla real ",(0,r.jsx)(s.code,{children:"pedido"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["Solo puede leer ",(0,r.jsx)(s.strong,{children:"lo que la vista expone"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["Esto a\xf1ade una ",(0,r.jsx)(s.strong,{children:"capa de seguridad y control"}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"228-buenas-pr\xe1cticas-con-usuarios-y-roles",children:"22.8. Buenas pr\xe1cticas con usuarios y roles"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"No uses cuentas compartidas entre personas."}),"\n",(0,r.jsx)(s.li,{children:"Usa roles para agrupar permisos comunes."}),"\n",(0,r.jsx)(s.li,{children:"Revoca permisos innecesarios."}),"\n",(0,r.jsx)(s.li,{children:"Usa vistas o funciones para exponer solo lo necesario."}),"\n",(0,r.jsx)(s.li,{children:"Documenta los permisos de cada rol."}),"\n",(0,r.jsx)(s.li,{children:"Revisa peri\xf3dicamente qui\xe9n tiene acceso a qu\xe9."}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"229-errores-comunes",children:"22.9. Errores comunes"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Dar a todos acceso total \u201cporque es m\xe1s c\xf3modo\u201d"}),"\n",(0,r.jsx)(s.li,{children:"Usar un \xfanico usuario para toda la aplicaci\xf3n."}),"\n",(0,r.jsx)(s.li,{children:"No separar permisos de lectura y escritura."}),"\n",(0,r.jsx)(s.li,{children:"No revocar permisos obsoletos."}),"\n",(0,r.jsx)(s.li,{children:"No documentar roles \u2192 p\xe9rdida de control con el tiempo."}),"\n"]})]})}function u(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>d});var i=n(6540);const r={},o=i.createContext(r);function a(e){const s=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(o.Provider,{value:s},e.children)}}}]);