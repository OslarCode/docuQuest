"use strict";(globalThis.webpackChunkDocuQuest_oslar_code=globalThis.webpackChunkDocuQuest_oslar_code||[]).push([[192],{2531:(r,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>t,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"backend/Node.js/manejoDeRutas","title":"Gu\xeda de Manejo de Rutas en Node.js con ES Modules","description":"Introducci\xf3n al Sistema de Rutas en Node.js","source":"@site/docs/backend/Node.js/manejoDeRutas.md","sourceDirName":"backend/Node.js","slug":"/backend/Node.js/manejoDeRutas","permalink":"/docuQuest/docs/backend/Node.js/manejoDeRutas","draft":false,"unlisted":false,"editUrl":"https://github.com/OslarCode/OslarCode/docs/backend/Node.js/manejoDeRutas.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"M\xf3dulos y gesti\xf3n de dependencias con NPM","permalink":"/docuQuest/docs/backend/Node.js/modulosGestionDependenciasNPM"},"next":{"title":"HTTP manejo de peticiones y respuestas ES Modules","permalink":"/docuQuest/docs/backend/Node.js/manejoDeHTTP"}}');var o=n(4848),s=n(8453);const t={},i="Gu\xeda de Manejo de Rutas en Node.js con ES Modules",c={},l=[{value:"Introducci\xf3n al Sistema de Rutas en Node.js",id:"introducci\xf3n-al-sistema-de-rutas-en-nodejs",level:2},{value:"Importante: Diferencia entre CommonJS y ES Modules",id:"importante-diferencia-entre-commonjs-y-es-modules",level:2},{value:"Explicaci\xf3n de <code>__dirname</code> y <code>__filename</code> en ES Modules",id:"explicaci\xf3n-de-__dirname-y-__filename-en-es-modules",level:3},{value:"C\xf3mo obtener <code>__dirname</code> y <code>__filename</code> en ES Modules",id:"c\xf3mo-obtener-__dirname-y-__filename-en-es-modules",level:3},{value:"M\xf3dulo Path - Manejo de Rutas del Sistema de Archivos",id:"m\xf3dulo-path---manejo-de-rutas-del-sistema-de-archivos",level:2},{value:"M\xe9todos Principales del M\xf3dulo Path",id:"m\xe9todos-principales-del-m\xf3dulo-path",level:3},{value:"path.join() - Unir Segmentos de Ruta",id:"pathjoin---unir-segmentos-de-ruta",level:4},{value:"path.resolve() - Resolver Rutas Absolutas",id:"pathresolve---resolver-rutas-absolutas",level:4},{value:"path.dirname() - Obtener Directorio Padre",id:"pathdirname---obtener-directorio-padre",level:4},{value:"path.basename() - Obtener Nombre del Archivo",id:"pathbasename---obtener-nombre-del-archivo",level:4},{value:"path.extname() - Obtener Extensi\xf3n del Archivo",id:"pathextname---obtener-extensi\xf3n-del-archivo",level:4},{value:"M\xf3dulo URL - Manejo de URLs",id:"m\xf3dulo-url---manejo-de-urls",level:2},{value:"Importaci\xf3n y Uso B\xe1sico",id:"importaci\xf3n-y-uso-b\xe1sico",level:3},{value:"An\xe1lisis de Par\xe1metros de Consulta",id:"an\xe1lisis-de-par\xe1metros-de-consulta",level:3},{value:"Implementaci\xf3n de un Servidor HTTP con Manejo de Rutas",id:"implementaci\xf3n-de-un-servidor-http-con-manejo-de-rutas",level:2},{value:"Servidor B\xe1sico con Enrutamiento",id:"servidor-b\xe1sico-con-enrutamiento",level:3},{value:"Sistema de Enrutamiento Avanzado con Par\xe1metros",id:"sistema-de-enrutamiento-avanzado-con-par\xe1metros",level:2},{value:"Implementaci\xf3n de Rutas con Par\xe1metros",id:"implementaci\xf3n-de-rutas-con-par\xe1metros",level:3},{value:"Mejores Pr\xe1cticas y Consideraciones",id:"mejores-pr\xe1cticas-y-consideraciones",level:2},{value:"1. Validaci\xf3n de Rutas",id:"1-validaci\xf3n-de-rutas",level:3},{value:"2. Configuraci\xf3n de MIME Types",id:"2-configuraci\xf3n-de-mime-types",level:3},{value:"3. Manejo de Errores Centralizado",id:"3-manejo-de-errores-centralizado",level:3},{value:"Conclusi\xf3n",id:"conclusi\xf3n",level:2}];function d(r){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...r.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"gu\xeda-de-manejo-de-rutas-en-nodejs-con-es-modules",children:"Gu\xeda de Manejo de Rutas en Node.js con ES Modules"})}),"\n",(0,o.jsx)(e.h2,{id:"introducci\xf3n-al-sistema-de-rutas-en-nodejs",children:"Introducci\xf3n al Sistema de Rutas en Node.js"}),"\n",(0,o.jsxs)(e.p,{children:["Node.js proporciona m\xf3dulos nativos para el manejo de rutas de archivos y URLs. Los principales m\xf3dulos son ",(0,o.jsx)(e.code,{children:"path"})," y ",(0,o.jsx)(e.code,{children:"url"}),", que ofrecen utilidades para trabajar con rutas del sistema de archivos y URLs respectivamente."]}),"\n",(0,o.jsx)(e.h2,{id:"importante-diferencia-entre-commonjs-y-es-modules",children:"Importante: Diferencia entre CommonJS y ES Modules"}),"\n",(0,o.jsxs)(e.h3,{id:"explicaci\xf3n-de-__dirname-y-__filename-en-es-modules",children:["Explicaci\xf3n de ",(0,o.jsx)(e.code,{children:"__dirname"})," y ",(0,o.jsx)(e.code,{children:"__filename"})," en ES Modules"]}),"\n",(0,o.jsxs)(e.p,{children:["En CommonJS (el sistema de m\xf3dulos antiguo de Node.js), las variables ",(0,o.jsx)(e.code,{children:"__dirname"})," y ",(0,o.jsx)(e.code,{children:"__filename"})," estaban disponibles autom\xe1ticamente. Sin embargo, en ES Modules (el est\xe1ndar moderno) necesitamos construirlas manualmente."]}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"\xbfPor qu\xe9 este cambio?"})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"ES Modules es un est\xe1ndar universal de JavaScript que funciona en navegadores y otros entornos"}),"\n",(0,o.jsxs)(e.li,{children:["Los navegadores no tienen sistema de archivos, por lo que ",(0,o.jsx)(e.code,{children:"__dirname"})," no tiene sentido all\xed"]}),"\n",(0,o.jsxs)(e.li,{children:["Node.js se adapta al est\xe1ndar usando ",(0,o.jsx)(e.code,{children:"import.meta.url"})]}),"\n"]}),"\n",(0,o.jsxs)(e.h3,{id:"c\xf3mo-obtener-__dirname-y-__filename-en-es-modules",children:["C\xf3mo obtener ",(0,o.jsx)(e.code,{children:"__dirname"})," y ",(0,o.jsx)(e.code,{children:"__filename"})," en ES Modules"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:'// IMPORTANTE: En ES Modules (la versi\xf3n moderna de JavaScript) no tenemos acceso directo a las variables __dirname y __filename\r\n// que s\xed estaban disponibles en CommonJS (la versi\xf3n antigua). Por eso necesitamos este c\xf3digo.\r\n\r\n// Importamos el m\xf3dulo \'path\' que nos permite trabajar con rutas de archivos y directorios\r\nimport path from "path";\r\n\r\n// Importamos la funci\xf3n \'fileURLToPath\' del m\xf3dulo \'url\' que convierte URLs de archivos en rutas de sistema\r\nimport { fileURLToPath } from "url";\r\n\r\n// \xbfQU\xc9 HACE ESTE C\xd3DIGO?\r\n// Necesitamos recrear las variables __filename y __dirname que nos dicen:\r\n// - __filename: La ruta completa del archivo actual\r\n// - __dirname: La carpeta donde est\xe1 ubicado el archivo actual\r\n\r\n// PASO 1: Obtener __filename (ruta completa del archivo)\r\n// import.meta.url nos da la URL del m\xf3dulo actual en formato "file:///ruta/completa/archivo.js"\r\n// fileURLToPath convierte esa URL en una ruta de sistema normal: "/ruta/completa/archivo.js"\r\nconst __filename = fileURLToPath(import.meta.url);\r\n\r\n// PASO 2: Obtener __dirname (carpeta contenedora)\r\n// path.dirname() toma una ruta de archivo y devuelve solo el directorio que lo contiene\r\n// Si __filename es "/usuarios/proyecto/app.js", __dirname ser\xe1 "/usuarios/proyecto"\r\nconst __dirname = path.dirname(__filename);\r\n\r\n// EJEMPLO PR\xc1CTICO:\r\n// Si este archivo se llama "app.js" y est\xe1 en "C:\\mi-proyecto\\src\\app.js"\r\n// __filename ser\xe1: "C:\\mi-proyecto\\src\\app.js" (o "/mi-proyecto/src/app.js" en Linux/Mac)\r\n// __dirname ser\xe1: "C:\\mi-proyecto\\src" (o "/mi-proyecto/src" en Linux/Mac)\r\n\r\n// Mostramos los resultados en consola\r\nconsole.log("Ruta del archivo:", __filename);\r\nconsole.log("Directorio:", __dirname);\r\n\r\n// \xbfPOR QU\xc9 ES \xdaTIL ESTO?\r\n// Estas variables son esenciales para:\r\n// - Leer archivos de configuraci\xf3n relativos al proyecto\r\n// - Acceder a recursos como im\xe1genes, plantillas, etc.\r\n// - Construir rutas din\xe1micas en tu aplicaci\xf3n\r\n\r\n// EJEMPLO DE USO PR\xc1CTICO:\r\n// const rutaConfig = path.join(__dirname, \'config\', \'database.json\');\r\n// const rutaImagen = path.join(__dirname, \'..\', \'assets\', \'logo.png\');\n'})}),"\n",(0,o.jsx)(e.h2,{id:"m\xf3dulo-path---manejo-de-rutas-del-sistema-de-archivos",children:"M\xf3dulo Path - Manejo de Rutas del Sistema de Archivos"}),"\n",(0,o.jsx)(e.h3,{id:"m\xe9todos-principales-del-m\xf3dulo-path",children:"M\xe9todos Principales del M\xf3dulo Path"}),"\n",(0,o.jsx)(e.h4,{id:"pathjoin---unir-segmentos-de-ruta",children:"path.join() - Unir Segmentos de Ruta"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:"// UNI\xd3N INTELIGENTE DE RUTAS CON path.join()\r\n\r\n// path.join() es como un \"constructor de rutas inteligente\" que:\r\n// - Combina m\xfaltiples partes de rutas\r\n// - Maneja autom\xe1ticamente las barras (/) seg\xfan el sistema operativo\r\n// - Resuelve referencias como '..' (directorio padre) y '.' (directorio actual)\r\n\r\n// EJEMPLO 1: Navegaci\xf3n entre directorios\r\nconst rutaCompleta = path.join(__dirname, 'archivos', 'documentos', '..', 'imagenes');\r\nconsole.log(rutaCompleta);\r\n// Ejemplo de salida: /ruta/al/proyecto/archivos/imagenes\r\n\r\n// DESGLOSE PASO A PASO de lo que hace path.join():\r\n// 1. __dirname = \"/ruta/al/proyecto\" (directorio base)\r\n// 2. + 'archivos' \u2192 \"/ruta/al/proyecto/archivos\"\r\n// 3. + 'documentos' \u2192 \"/ruta/al/proyecto/archivos/documentos\"\r\n// 4. + '..' (SUBIR un nivel) \u2192 \"/ruta/al/proyecto/archivos\"\r\n// 5. + 'imagenes' \u2192 \"/ruta/al/proyecto/archivos/imagenes\"\r\n\r\n// EL '..' ES CLAVE: Te permite \"retroceder\" en la estructura de carpetas\r\n// Es como decir: \"ve a documentos, luego vuelve atr\xe1s, y entra en imagenes\"\r\n\r\n// EJEMPLO 2: Uso pr\xe1ctico para archivos est\xe1ticos en un servidor web\r\nconst rutaArchivo = path.join(__dirname, 'public', 'css', 'estilos.css');\r\nconsole.log(Sirviendo archivo: ${rutaArchivo});\r\n// Ejemplo de salida: Sirviendo archivo: /ruta/al/proyecto/public/css/estilos.css\r\n\r\n// ESTRUCTURA DE CARPETAS EJEMPLO:\r\n// mi-proyecto/\r\n// \u251c\u2500\u2500 app.js (este archivo)\r\n// \u251c\u2500\u2500 public/\r\n// \u2502   \u251c\u2500\u2500 css/\r\n// \u2502   \u2502   \u2514\u2500\u2500 estilos.css\r\n// \u2502   \u2514\u2500\u2500 imagenes/\r\n// \u2514\u2500\u2500 archivos/\r\n//     \u251c\u2500\u2500 documentos/\r\n//     \u2514\u2500\u2500 imagenes/\r\n\r\n// VENTAJAS DE USAR path.join() vs concatenar strings:\r\n// 1. EVITA ERRORES con las barras:\r\n//    path.join('carpeta', 'subcarpeta') \u2192 \"carpeta/subcarpeta\" (Linux/Mac) o \"carpeta\\subcarpeta\" (Windows)\r\n//    'carpeta' + '/' + 'subcarpeta' \u2192 Puede fallar en Windows\r\n\r\n// 2. NORMALIZA LA RUTA autom\xe1ticamente:\r\n//    path.join('carpeta//', 'subcarpeta/') \u2192 \"carpeta/subcarpeta\"\r\n\r\n// 3. MANEJA REFERENCIAS RELATIVAS:\r\n//    path.join('carpeta', '..', 'otra-carpeta') \u2192 \"otra-carpeta\"\r\n\r\n// USOS COMUNES EN DESARROLLO WEB:\r\n// - Servir archivos est\xe1ticos (CSS, JS, im\xe1genes)\r\n// - Configurar rutas de plantillas\r\n// - Acceder a archivos de configuraci\xf3n\r\n// - Definir rutas de uploads o logs\r\n\r\n// IMPORTANTE: path.join() NO verifica si la ruta existe, solo la construye\r\n// Para verificar existencia necesitar\xedas el m\xf3dulo 'fs'\n"})}),"\n",(0,o.jsx)(e.h4,{id:"pathresolve---resolver-rutas-absolutas",children:"path.resolve() - Resolver Rutas Absolutas"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:"// RESOLUCI\xd3N DE RUTAS ABSOLUTAS CON path.resolve()\r\n\r\n// path.resolve() construye una ruta absoluta resolviendo una secuencia de rutas relativas\r\n// A diferencia de path.join(), resolve() siempre retorna una ruta absoluta completa\r\n// Funciona resolviendo las rutas de derecha a izquierda hasta construir una ruta absoluta\r\n\r\n// Ejemplo b\xe1sico: Resolver rutas relativas desde el directorio actual de trabajo\r\nconst rutaAbsoluta = path.resolve(\"src\", \"components\", \"Header.jsx\");\r\nconsole.log(rutaAbsoluta);\r\n// Ejemplo: /ruta/actual/src/components/Header.jsx\r\n\r\n// Como funciona path.resolve():\r\n// 1. Toma los segmentos: 'src', 'components', 'Header.jsx'\r\n// 2. Comienza desde el directorio actual de trabajo (process.cwd())\r\n// 3. Construye la ruta absoluta combinando el directorio actual con los segmentos\r\n\r\n// Ejemplo pr\xe1ctico con __dirname para mayor precisi\xf3n\r\nconst configPath = path.resolve(__dirname, \"config\", \"database.json\");\r\nconsole.log(`Archivo de configuraci\xf3n: ${configPath}`);\r\n\r\n// DIFERENCIAS CLAVE ENTRE path.join() Y path.resolve():\r\n\r\n// path.join() - Solo une rutas, mantiene el tipo (relativa/absoluta)\r\n// Ejemplo: path.join('a', 'b', 'c') \u2192 \"a/b/c\" (ruta relativa)\r\n\r\n// path.resolve() - Siempre retorna ruta absoluta\r\n// Ejemplo: path.resolve('a', 'b', 'c') \u2192 \"/directorio/actual/a/b/c\" (ruta absoluta)\r\n\r\n// COMPORTAMIENTO DE path.resolve() CON M\xdaLTIPLES ARGUMENTOS:\r\n// Resuelve de derecha a izquierda hasta encontrar una ruta absoluta\r\n\r\n// Ejemplo: path.resolve('/a', '/b', 'c')\r\n// 1. Comienza con 'c' (relativo)\r\n// 2. Luego '/b' (absoluto) \u2192 descarta todo lo anterior\r\n// 3. Resultado: '/b/c'\r\n\r\n// CASOS DE USO T\xcdPICOS PARA path.resolve():\r\n\r\n// 1. Configuraci\xf3n de aplicaciones - Para asegurar rutas absolutas a archivos de config\r\n// 2. Servidores web - Para definir rutas absolutas a recursos est\xe1ticos\r\n// 3. Scripts de build - Para referenciar archivos de manera precisa\r\n// 4. Herramientas de desarrollo - Cuando necesitas rutas completas y no relativas\r\n\r\n// EJEMPLO ADICIONAL: Resoluci\xf3n desde diferentes puntos\r\nconst ruta1 = path.resolve(\".\"); // Directorio actual de trabajo\r\nconst ruta2 = path.resolve(\"..\"); // Directorio padre del directorio actual\r\nconst ruta3 = path.resolve(\"/home\", \"usuario\", \"proyecto\"); // Ruta absoluta expl\xedcita\r\n\r\nconsole.log(\"Directorio actual:\", ruta1);\r\nconsole.log(\"Directorio padre:\", ruta2);\r\nconsole.log(\"Ruta expl\xedcita:\", ruta3);\n"})}),"\n",(0,o.jsx)(e.h4,{id:"pathdirname---obtener-directorio-padre",children:"path.dirname() - Obtener Directorio Padre"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:'// OBTENCI\xd3N DEL DIRECTORIO PADRE CON path.dirname()\r\n\r\n// path.dirname() es una funci\xf3n que extrae la parte del directorio de una ruta de archivo\r\n// Es equivalente a obtener todo lo que est\xe1 antes de la \xfaltima barra en una ruta\r\n\r\n// Ejemplo b\xe1sico: Extraer el directorio de una ruta absoluta\r\nconst directorio = path.dirname("/usuarios/juan/proyecto/src/app.js");\r\nconsole.log(directorio); // /usuarios/juan/proyecto/src\r\n\r\n// Como funciona path.dirname():\r\n// - Toma una ruta completa como entrada\r\n// - Elimina el \xfaltimo segmento (el nombre del archivo)\r\n// - Retorna la ruta del directorio que contiene el archivo\r\n\r\n// Ejemplos adicionales para entender el comportamiento:\r\nconst ejemplo1 = path.dirname("/a/b/c/d.txt"); // Retorna: \'/a/b/c\'\r\nconst ejemplo2 = path.dirname("/a/b/c/"); // Retorna: \'/a/b/c\'\r\nconst ejemplo3 = path.dirname("archivo.js"); // Retorna: \'.\' (directorio actual)\r\nconst ejemplo4 = path.dirname("/solo/"); // Retorna: \'/solo\'\r\n\r\n// Uso pr\xe1ctico con __filename en aplicaciones reales\r\nconsole.log(`Directorio actual: ${__dirname}`);\r\n\r\n// DIFERENCIA ENTRE __dirname Y path.dirname(__filename):\r\n// - __dirname ya contiene el directorio del archivo actual\r\n// - path.dirname(__filename) har\xeda lo mismo pero es redundante\r\n// - __dirname es m\xe1s directo y eficiente para este caso espec\xedfico\r\n\r\n// CASOS DE USO COMUNES PARA path.dirname():\r\n\r\n// 1. Navegaci\xf3n en estructuras de archivos\r\nconst configDir = path.dirname("/proyecto/config/database.json");\r\n// Resultado: \'/proyecto/config\'\r\n\r\n// 2. Obtener directorios padres m\xfaltiples niveles\r\nconst proyectoDir = path.dirname(path.dirname("/proyecto/src/app.js"));\r\n// Resultado: \'/proyecto\' (sube dos niveles)\r\n\r\n// 3. Procesamiento de rutas din\xe1micas\r\nfunction obtenerDirectorioContenedor(rutaArchivo) {\r\n  return path.dirname(rutaArchivo);\r\n}\r\n\r\n// 4. En combinaci\xf3n con otras funciones de path\r\nconst rutaCompleta = "/home/usuario/documentos/informe.pdf";\r\nconst directorioPadre = path.dirname(rutaCompleta);\r\nconst nombreArchivo = path.basename(rutaCompleta);\r\n\r\nconsole.log(`Archivo: ${nombreArchivo}`);\r\nconsole.log(`Ubicado en: ${directorioPadre}`);\r\n\r\n// IMPORTANTE: path.dirname() trabaja exclusivamente con an\xe1lisis de strings\r\n// No verifica si la ruta existe en el sistema de archivos\r\n// Solo realiza operaciones de manipulaci\xf3n de strings basadas en las barras de directorio\n'})}),"\n",(0,o.jsx)(e.h4,{id:"pathbasename---obtener-nombre-del-archivo",children:"path.basename() - Obtener Nombre del Archivo"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:'// OBTENCI\xd3N DEL NOMBRE DE ARCHIVO CON path.basename()\r\n\r\n// path.basename() es una funci\xf3n que extrae la \xfaltima parte de una ruta de archivo\r\n// Es decir, obtiene el nombre del archivo o directorio final de una ruta\r\n\r\n// Ejemplo b\xe1sico: Extraer el nombre de archivo de una ruta completa\r\nconst nombreArchivo = path.basename("/usuarios/juan/documento.txt");\r\nconsole.log(nombreArchivo); // documento.txt\r\n\r\n// Como funciona path.basename():\r\n// - Toma una ruta completa como entrada\r\n// - Identifica el \xfaltimo segmento despu\xe9s de la \xfaltima barra\r\n// - Retorna solo el nombre del archivo o directorio final\r\n\r\n// Ejemplos adicionales para entender el comportamiento:\r\nconst ejemplo1 = path.basename("/a/b/c/d.txt"); // Retorna: \'d.txt\'\r\nconst ejemplo2 = path.basename("/a/b/c/"); // Retorna: \'c\'\r\nconst ejemplo3 = path.basename("archivo.js"); // Retorna: \'archivo.js\'\r\nconst ejemplo4 = path.basename("/solo/"); // Retorna: \'solo\'\r\n\r\n// USO CON SEGUNDO PAR\xc1METRO PARA ELIMINAR EXTENSI\xd3N\r\n// El segundo par\xe1metro opcional permite remover una extensi\xf3n espec\xedfica\r\nconst nombreSinExtension = path.basename(\r\n  "/usuarios/juan/documento.txt",\r\n  ".txt"\r\n);\r\nconsole.log(nombreSinExtension); // documento\r\n\r\n// El segundo par\xe1metro debe coincidir exactamente con la extensi\xf3n a remover\r\n// Incluyendo el punto y siendo case-sensitive en algunos sistemas\r\n\r\n// Ejemplos con el segundo par\xe1metro:\r\nconst ejemplo5 = path.basename("/ruta/archivo.html", ".html"); // \'archivo\'\r\nconst ejemplo6 = path.basename("/ruta/archivo.js", ".js"); // \'archivo\'\r\nconst ejemplo7 = path.basename("/ruta/archivo.txt", ".js"); // \'archivo.txt\' (no coincide)\r\n\r\n// CASOS DE USO COMUNES PARA path.basename():\r\n\r\n// 1. Procesamiento de archivos subidos\r\nconst archivoSubido = "/tmp/upload/imagen_usuario.jpg";\r\nconst nombreArchivoSubido = path.basename(archivoSubido);\r\n// \xdatil para renombrar o almacenar referencias\r\n\r\n// 2. Generaci\xf3n de nombres de archivo para descargas\r\nfunction generarNombreDescarga(rutaCompleta) {\r\n  return path.basename(rutaCompleta);\r\n}\r\n\r\n// 3. An\xe1lisis de logs o listados de archivos\r\nconst rutasArchivos = ["/var/log/app/error.log", "/var/log/app/access.log"];\r\nconst nombresArchivos = rutasArchivos.map((ruta) => path.basename(ruta));\r\n// Resultado: [\'error.log\', \'access.log\']\r\n\r\n// 4. En combinaci\xf3n con otras funciones de path\r\nconst rutaCompleta = "/home/usuario/documentos/informe.pdf";\r\nconst directorio = path.dirname(rutaCompleta);\r\nconst archivo = path.basename(rutaCompleta);\r\nconst archivoSinExtension = path.basename(rutaCompleta, ".pdf");\r\n\r\nconsole.log(`Directorio: ${directorio}`);\r\nconsole.log(`Archivo completo: ${archivo}`);\r\nconsole.log(`Nombre sin extensi\xf3n: ${archivoSinExtension}`);\r\n\r\n// DIFERENCIA CON OTRAS FUNCIONES RELACIONADAS:\r\n// - path.basename(): obtiene el archivo final\r\n// - path.dirname(): obtiene el directorio contenedor\r\n// - path.extname(): obtiene solo la extensi\xf3n del archivo\n'})}),"\n",(0,o.jsx)(e.h4,{id:"pathextname---obtener-extensi\xf3n-del-archivo",children:"path.extname() - Obtener Extensi\xf3n del Archivo"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:'// OBTENCI\xd3N DE LA EXTENSI\xd3N DE ARCHIVO CON path.extname()\r\n\r\n// path.extname() es una funci\xf3n que extrae la extensi\xf3n de un archivo desde una ruta\r\n// Retorna la extensi\xf3n incluyendo el punto, o una cadena vac\xeda si no hay extensi\xf3n\r\n\r\n// Ejemplo b\xe1sico: Extraer la extensi\xf3n de una ruta de archivo\r\nconst extension = path.extname("/usuarios/juan/imagen.jpg");\r\nconsole.log(extension); // .jpg\r\n\r\n// Como funciona path.extname():\r\n// - Analiza la ruta buscando el \xfaltimo punto despu\xe9s de la \xfaltima barra\r\n// - Retorna todo desde ese punto hasta el final de la cadena\r\n// - Si no hay punto, o el punto est\xe1 en el directorio, retorna cadena vac\xeda\r\n\r\n// Ejemplos adicionales para entender el comportamiento:\r\nconst ejemplo1 = path.extname("/a/b/c/d.txt"); // Retorna: \'.txt\'\r\nconst ejemplo2 = path.extname("/a/b/c/archivo"); // Retorna: \'\' (sin extensi\xf3n)\r\nconst ejemplo3 = path.extname("/a/b/c/archivo.js"); // Retorna: \'.js\'\r\nconst ejemplo4 = path.extname("/a/b.c/d"); // Retorna: \'\' (el punto est\xe1 en el directorio)\r\nconst ejemplo5 = path.extname("/a/b/.archivoculto"); // Retorna: \'\' (archivo oculto sin extensi\xf3n)\r\n\r\n// CASO DE USO PR\xc1CTICO: Detecci\xf3n de tipos de archivo\r\nconst archivo = "/ruta/al/archivo.js";\r\nif (path.extname(archivo) === ".js") {\r\n  console.log("Es un archivo JavaScript");\r\n}\r\n\r\n// Este patr\xf3n es muy com\xfan en aplicaciones web para:\r\n// - Identificar tipos de archivo para procesamiento\r\n// - Aplicar l\xf3gica espec\xedfica seg\xfan el tipo de archivo\r\n// - Validar extensiones permitidas\r\n\r\n// EJEMPLOS M\xc1S COMPLEJOS DE DETECCI\xd3N DE EXTENSIONES:\r\n\r\n// 1. Validaci\xf3n de m\xfaltiples extensiones en un servidor web\r\nconst archivoSolicitado = "/static/css/estilos.css";\r\nconst ext = path.extname(archivoSolicitado);\r\n\r\nif (ext === ".css") {\r\n  console.log("Serviendo archivo CSS");\r\n} else if (ext === ".js") {\r\n  console.log("Serviendo archivo JavaScript");\r\n} else if (ext === ".html") {\r\n  console.log("Serviendo archivo HTML");\r\n} else {\r\n  console.log("Tipo de archivo no reconocido");\r\n}\r\n\r\n// 2. Filtrado de archivos por extensi\xf3n\r\nconst archivos = ["app.js", "style.css", "index.html", "README"];\r\nconst archivosJs = archivos.filter(\r\n  (archivo) => path.extname(archivo) === ".js"\r\n);\r\nconsole.log("Archivos JavaScript:", archivosJs); // [\'app.js\']\r\n\r\n// 3. Configuraci\xf3n de MIME types basados en extensi\xf3n\r\nfunction obtenerTipoMIME(rutaArchivo) {\r\n  const extension = path.extname(rutaArchivo);\r\n  const tiposMIME = {\r\n    ".html": "text/html",\r\n    ".css": "text/css",\r\n    ".js": "application/javascript",\r\n    ".json": "application/json",\r\n    ".png": "image/png",\r\n    ".jpg": "image/jpeg",\r\n  };\r\n  return tiposMIME[extension] || "application/octet-stream";\r\n}\r\n\r\n// 4. En combinaci\xf3n con path.basename() para an\xe1lisis completo\r\nconst rutaCompleta = "/proyecto/src/componentes/App.jsx";\r\nconst nombreArchivo = path.basename(rutaCompleta); // \'App.jsx\'\r\nconst extensionArchivo = path.extname(rutaCompleta); // \'.jsx\'\r\nconst nombreBase = path.basename(rutaCompleta, extensionArchivo); // \'App\'\r\n\r\nconsole.log(`Nombre: ${nombreArchivo}`);\r\nconsole.log(`Extensi\xf3n: ${extensionArchivo}`);\r\nconsole.log(`Nombre base: ${nombreBase}`);\r\n\r\n// LIMITACIONES IMPORTANTES:\r\n// - path.extname() solo analiza la cadena, no verifica la existencia del archivo\r\n// - No valida que la extensi\xf3n corresponda a un tipo de archivo real\r\n// - Archivos pueden tener m\xfaltiples extensiones (ej: \'.tar.gz\') pero extname() solo toma la \xfaltima\n'})}),"\n",(0,o.jsx)(e.h2,{id:"m\xf3dulo-url---manejo-de-urls",children:"M\xf3dulo URL - Manejo de URLs"}),"\n",(0,o.jsx)(e.h3,{id:"importaci\xf3n-y-uso-b\xe1sico",children:"Importaci\xf3n y Uso B\xe1sico"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:'// Importaci\xf3n de la clase URL del m\xf3dulo url\r\n// En Node.js, URL es parte del m\xf3dulo url pero tambi\xe9n est\xe1 disponible globalmente en versiones modernas\r\nimport { URL } from "url";\r\n\r\n// Crear una nueva instancia de URL\r\n// La clase URL permite analizar y manipular URLs de manera estructurada\r\n// Se construye pasando la URL completa como string al constructor\r\nconst miUrl = new URL(\r\n  "https://ejemplo.com:8080/ruta/api?usuario=john&pagina=1#seccion"\r\n);\r\n\r\n// PROPIEDADES PRINCIPALES DE LA INSTANCIA URL:\r\n\r\n// protocol - Obtiene el protocolo de la URL (incluye los dos puntos)\r\nconsole.log(miUrl.protocol); // https:\r\n\r\n// hostname - Obtiene el nombre del host o dominio sin el puerto\r\nconsole.log(miUrl.hostname); // ejemplo.com\r\n\r\n// port - Obtiene el n\xfamero de puerto si est\xe1 especificado en la URL\r\nconsole.log(miUrl.port); // 8080\r\n\r\n// pathname - Obtiene la ruta del recurso en el servidor (incluye la barra inicial)\r\nconsole.log(miUrl.pathname); // /ruta/api\r\n\r\n// search - Obtiene la cadena de consulta completa incluyendo el signo de interrogaci\xf3n\r\nconsole.log(miUrl.search); // ?usuario=john&pagina=1\r\n\r\n// hash - Obtiene el fragmento o ancla de la URL incluyendo el signo de numeral\r\nconsole.log(miUrl.hash); // #seccion\r\n\r\n// OTRAS PROPIEDADES \xdaTILES DE LA CLASE URL:\r\n\r\n// host - Incluye el nombre del host y el puerto\r\nconsole.log(miUrl.host); // ejemplo.com:8080\r\n\r\n// origin - Obtiene el origen de la URL (protocolo + hostname + puerto)\r\nconsole.log(miUrl.origin); // https://ejemplo.com:8080\r\n\r\n// searchParams - Objeto URLSearchParams para manipular par\xe1metros de consulta\r\nconsole.log(miUrl.searchParams); // Objeto con m\xe9todos para trabajar con query parameters\r\n\r\n// Ejemplos de uso con searchParams:\r\nconsole.log(miUrl.searchParams.get("usuario")); // \'john\'\r\nconsole.log(miUrl.searchParams.get("pagina")); // \'1\'\r\n\r\n// href - La URL completa como string\r\nconsole.log(miUrl.href); // https://ejemplo.com:8080/ruta/api?usuario=john&pagina=1#seccion\r\n\r\n// CASOS DE USO PR\xc1CTICOS:\r\n\r\n// 1. Validaci\xf3n y an\xe1lisis de URLs ingresadas por usuarios\r\nfunction analizarURL(urlString) {\r\n  try {\r\n    const url = new URL(urlString);\r\n    return {\r\n      dominio: url.hostname,\r\n      ruta: url.pathname,\r\n      parametros: Object.fromEntries(url.searchParams),\r\n      esSegura: url.protocol === "https:",\r\n    };\r\n  } catch (error) {\r\n    console.log("URL inv\xe1lida:", error.message);\r\n    return null;\r\n  }\r\n}\r\n\r\n// 2. Construcci\xf3n de URLs din\xe1micas\r\nconst baseURL = "https://api.mi-servicio.com";\r\nconst endpoint = "/usuarios";\r\nconst parametros = { limite: 10, pagina: 2 };\r\n\r\nconst urlCompleta = new URL(endpoint, baseURL);\r\nurlCompleta.search = new URLSearchParams(parametros).toString();\r\nconsole.log(urlCompleta.href); // https://api.mi-servicio.com/usuarios?limite=10&pagina=2\r\n\r\n// 3. Manipulaci\xf3n de par\xe1metros de consulta\r\nconst urlConParametros = new URL("https://ejemplo.com/buscar");\r\nurlConParametros.searchParams.set("q", "node.js");\r\nurlConParametros.searchParams.set("sort", "fecha");\r\nconsole.log(urlConParametros.href); // https://ejemplo.com/buscar?q=node.js&sort=fecha\r\n\r\n// MANEJO DE ERRORES:\r\n// El constructor URL lanzar\xe1 un error si la URL no es v\xe1lida\r\ntry {\r\n  const urlInvalida = new URL("esto-no-es-una-url");\r\n} catch (error) {\r\n  console.log("Error al crear URL:", error.message);\r\n}\n'})}),"\n",(0,o.jsx)(e.h3,{id:"an\xe1lisis-de-par\xe1metros-de-consulta",children:"An\xe1lisis de Par\xe1metros de Consulta"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:"// Obtener par\xe1metros de consulta\r\n// searchParams devuelve un objeto URLSearchParams que proporciona m\xe9todos para trabajar con los par\xe1metros de consulta (query parameters)\r\nconst parametros = miUrl.searchParams;\r\n\r\n// M\xc9TODOS PRINCIPALES DE URLSearchParams:\r\n\r\n// get() - Obtiene el valor del primer par\xe1metro con la clave especificada\r\nconsole.log(parametros.get('usuario')); // john\r\n\r\n// get() - Si el par\xe1metro no existe, retorna null\r\nconsole.log(parametros.get('pagina'));  // 1\r\n\r\n// has() - Verifica si existe un par\xe1metro con la clave especificada\r\n// Retorna true si existe, false si no existe\r\nconsole.log(parametros.has('busqueda')); // false\r\n\r\n// Iterar sobre todos los par\xe1metros\r\n// URLSearchParams es iterable, permite recorrer todos los par\xe1metros como pares [clave, valor]\r\nfor (const [clave, valor] de parametros) {\r\n    console.log(`${clave}: ${valor}`);\r\n}\r\n// Salida esperada:\r\n// usuario: john\r\n// pagina: 1\r\n\r\n// OTROS M\xc9TODOS \xdaTILES DE URLSearchParams:\r\n\r\n// getAll() - Obtiene todos los valores de un par\xe1metro (\xfatil cuando hay m\xfaltiples valores con la misma clave)\r\nconst urlConDuplicados = new URL('https://ejemplo.com?color=rojo&color=azul');\r\nconsole.log(urlConDuplicados.searchParams.getAll('color')); // ['rojo', 'azul']\r\n\r\n// set() - Establece o actualiza el valor de un par\xe1metro\r\nparametros.set('nuevoParametro', 'valor123');\r\nconsole.log(parametros.get('nuevoParametro')); // valor123\r\n\r\n// append() - Agrega un nuevo valor sin eliminar los existentes (para par\xe1metros con m\xfaltiples valores)\r\nparametros.append('categoria', 'tecnologia');\r\nparametros.append('categoria', 'programacion');\r\n\r\n// delete() - Elimina un par\xe1metro espec\xedfico\r\nparametros.delete('pagina');\r\nconsole.log(parametros.has('pagina')); // false\r\n\r\n// toString() - Convierte los par\xe1metros a string en formato URL\r\nconsole.log(parametros.toString()); // usuario=john&nuevoParametro=valor123&categoria=tecnologia&categoria=programacion\r\n\r\n// keys() - Obtiene un iterador con todas las claves\r\nfor (const clave de parametros.keys()) {\r\n    console.log('Clave:', clave);\r\n}\r\n\r\n// values() - Obtiene un iterador con todos los valores\r\nfor (const valor de parametros.values()) {\r\n    console.log('Valor:', valor);\r\n}\r\n\r\n// entries() - Obtiene un iterador con todos los pares [clave, valor] (es lo mismo que iterar directamente)\r\nfor (const [clave, valor] de parametros.entries()) {\r\n    console.log(`Entrada: ${clave} = ${valor}`);\r\n}\r\n\r\n// CASOS DE USO PR\xc1CTICOS:\r\n\r\n// 1. Procesamiento de formularios web\r\nfunction procesarFormulario(urlString) {\r\n    const url = new URL(urlString);\r\n    const datos = {};\r\n\r\n    for (const [clave, valor] de url.searchParams) {\r\n        datos[clave] = valor;\r\n    }\r\n\r\n    return datos;\r\n}\r\n\r\n// 2. Validaci\xf3n de par\xe1metros requeridos\r\nfunction validarParametros(urlString, parametrosRequeridos) {\r\n    const url = new URL(urlString);\r\n\r\n    for (const parametro of parametrosRequeridos) {\r\n        if (!url.searchParams.has(parametro)) {\r\n            throw new Error(`Falta el par\xe1metro requerido: ${parametro}`);\r\n        }\r\n    }\r\n\r\n    return true;\r\n}\r\n\r\n// 3. Construcci\xf3n din\xe1mica de URLs con par\xe1metros\r\nfunction construirURL(base, parametros) {\r\n    const url = new URL(base);\r\n\r\n    Object.entries(parametros).forEach(([clave, valor]) => {\r\n        url.searchParams.set(clave, valor);\r\n    });\r\n\r\n    return url.href;\r\n}\r\n\r\n// 4. Limpieza de par\xe1metros sensibles\r\nfunction limpiarURLSensible(urlString) {\r\n    const url = new URL(urlString);\r\n    const parametrosSensibles = ['password', 'token', 'apiKey'];\r\n\r\n    parametrosSensibles.forEach(param => {\r\n        if (url.searchParams.has(param)) {\r\n            url.searchParams.delete(param);\r\n        }\r\n    });\r\n\r\n    return url.href;\r\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"implementaci\xf3n-de-un-servidor-http-con-manejo-de-rutas",children:"Implementaci\xf3n de un Servidor HTTP con Manejo de Rutas"}),"\n",(0,o.jsx)(e.h3,{id:"servidor-b\xe1sico-con-enrutamiento",children:"Servidor B\xe1sico con Enrutamiento"}),"\n",(0,o.jsx)(e.p,{children:"Te explico este servidor HTTP completo en partes:"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"PRIMERA PARTE: CONFIGURACI\xd3N INICIAL E IMPORTACIONES"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:'import http from "http";\r\nimport path from "path";\r\nimport { fileURLToPath } from "url";\r\nimport fs from "fs/promises";\r\n\r\n// Obtener __dirname y __filename para ES Modules\r\n// Esto es necesario porque en ES Modules no tenemos acceso directo a estas variables\r\nconst __filename = fileURLToPath(import.meta.url);\r\nconst __dirname = path.dirname(__filename);\r\n\r\n// Crear el servidor HTTP\r\n// http.createServer() recibe una funci\xf3n callback que se ejecuta en cada solicitud\r\n// La funci\xf3n callback recibe dos par\xe1metros: req (solicitud) y res (respuesta)\r\nconst server = http.createServer(async (req, res) => {\r\n  // Analizar la URL solicitada usando la clase URL\r\n  // Se construye la URL completa usando el host de los headers de la solicitud\r\n  const url = new URL(req.url, `http://${req.headers.host}`);\r\n  const rutaSolicitada = url.pathname;\r\n\r\n  console.log(`Solicitud recibida: ${rutaSolicitada}`);\r\n\r\n  // Configurar headers b\xe1sicos para la respuesta\r\n  // Por defecto, todas las respuestas ser\xe1n HTML con codificaci\xf3n UTF-8\r\n  res.setHeader("Content-Type", "text/html; charset=utf-8");\r\n\r\n  try {\r\n    // Sistema de enrutamiento basado en la ruta solicitada\r\n    // switch-case es un patr\xf3n com\xfan para manejar diferentes rutas\r\n    switch (rutaSolicitada) {\r\n      case "/":\r\n        await servirPaginaInicio(res);\r\n        break;\r\n      case "/acerca":\r\n        await servirPaginaAcerca(res);\r\n        break;\r\n      case "/contacto":\r\n        await servirPaginaContacto(res);\r\n        break;\r\n      default:\r\n        // Si no es una ruta definida, verificar si es un archivo est\xe1tico\r\n        if (await esArchivoEstatico(rutaSolicitada)) {\r\n          await servirArchivoEstatico(rutaSolicitada, res);\r\n        } else {\r\n          // Si no es archivo est\xe1tico ni ruta definida, mostrar error 404\r\n          servirError404(res, rutaSolicitada);\r\n        }\r\n    }\r\n  } catch (error) {\r\n    // Manejo centralizado de errores\r\n    // Cualquier error no controlado en las funciones anteriores llegar\xe1 aqu\xed\r\n    console.error("Error al procesar solicitud:", error);\r\n    servirError500(res, error);\r\n  }\r\n});\n'})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"SEGUNDA PARTE: FUNCIONES DE P\xc1GINAS Y ARCHIVOS EST\xc1TICOS"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:'// Funci\xf3n para servir la p\xe1gina de inicio\r\n// Genera HTML din\xe1micamente como string\r\nasync function servirPaginaInicio(res) {\r\n  const contenido = `\r\n        <!DOCTYPE html>\r\n        <html>\r\n        <head>\r\n            <title>P\xe1gina de Inicio</title>\r\n        </head>\r\n        <body>\r\n            <h1>Bienvenido a la P\xe1gina de Inicio</h1>\r\n            <nav>\r\n                <a href="/">Inicio</a> |\r\n                <a href="/acerca">Acerca</a> |\r\n                <a href="/contacto">Contacto</a>\r\n            </nav>\r\n            <p>Esta es la p\xe1gina principal del sitio.</p>\r\n        </body>\r\n        </html>\r\n    `;\r\n\r\n  // Establecer c\xf3digo de estado 200 (OK) y enviar el contenido\r\n  res.statusCode = 200;\r\n  res.end(contenido);\r\n}\r\n\r\n// Funci\xf3n similar para la p\xe1gina "Acerca de"\r\nasync function servirPaginaAcerca(res) {\r\n  const contenido = `\r\n        <!DOCTYPE html>\r\n        <html>\r\n        <head>\r\n            <title>Acerca de Nosotros</title>\r\n        </head>\r\n        <body>\r\n            <h1>Acerca de Nosotros</h1>\r\n            <nav>\r\n                <a href="/">Inicio</a> |\r\n                <a href="/acerca">Acerca</a> |\r\n                <a href="/contacto">Contacto</a>\r\n            </nav>\r\n            <p>Informaci\xf3n sobre nuestra empresa.</p>\r\n        </body>\r\n        </html>\r\n    `;\r\n\r\n  res.statusCode = 200;\r\n  res.end(contenido);\r\n}\r\n\r\n// Funci\xf3n para verificar si una ruta corresponde a un archivo est\xe1tico\r\n// Comprueba si la extensi\xf3n del archivo est\xe1 en la lista de extensiones permitidas\r\nasync function esArchivoEstatico(ruta) {\r\n  const extensionesPermitidas = [\r\n    ".css",\r\n    ".js",\r\n    ".png",\r\n    ".jpg",\r\n    ".json",\r\n    ".txt",\r\n  ];\r\n  const extension = path.extname(ruta);\r\n  return extensionesPermitidas.includes(extension);\r\n}\r\n\r\n// Funci\xf3n para servir archivos est\xe1ticos desde el directorio \'public\'\r\nasync function servirArchivoEstatico(rutaSolicitada, res) {\r\n  try {\r\n    // Construir la ruta completa al archivo\r\n    // path.join() asegura que la ruta sea correcta independientemente del SO\r\n    const rutaCompleta = path.join(__dirname, "public", rutaSolicitada);\r\n\r\n    // Leer el contenido del archivo usando fs/promises (versi\xf3n as\xedncrona)\r\n    const contenido = await fs.readFile(rutaCompleta);\r\n\r\n    // Determinar el tipo MIME basado en la extensi\xf3n del archivo\r\n    // Esto es importante para que el navegador interprete correctamente el contenido\r\n    const extension = path.extname(rutaSolicitada);\r\n    const tiposMIME = {\r\n      ".css": "text/css",\r\n      ".js": "application/javascript",\r\n      ".png": "image/png",\r\n      ".jpg": "image/jpeg",\r\n      ".json": "application/json",\r\n      ".txt": "text/plain",\r\n    };\r\n\r\n    // Establecer el Content-Type apropiado para el tipo de archivo\r\n    res.setHeader(\r\n      "Content-Type",\r\n      tiposMIME[extension] || "application/octet-stream"\r\n    );\r\n    res.statusCode = 200;\r\n    res.end(contenido);\r\n  } catch (error) {\r\n    // Si el archivo no existe (error ENOENT), mostrar error 404\r\n    if (error.code === "ENOENT") {\r\n      servirError404(res, rutaSolicitada);\r\n    } else {\r\n      // Para otros errores, relanzar la excepci\xf3n para que sea capturada por el manejador global\r\n      throw error;\r\n    }\r\n  }\r\n}\n'})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"TERCERA PARTE: MANEJO DE ERRORES Y INICIO DEL SERVIDOR"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:'// Funci\xf3n para manejar errores 404 (P\xe1gina no encontrada)\r\nfunction servirError404(res, ruta) {\r\n  res.statusCode = 404; // C\xf3digo de estado HTTP para "No encontrado"\r\n  res.end(`\r\n        <!DOCTYPE html>\r\n        <html>\r\n        <head>\r\n            <title>P\xe1gina No Encontrada</title>\r\n        </head>\r\n        <body>\r\n            <h1>Error 404 - P\xe1gina No Encontrada</h1>\r\n            <p>La ruta "${ruta}" no existe en este servidor.</p>\r\n            <a href="/">Volver al Inicio</a>\r\n        </body>\r\n        </html>\r\n    `);\r\n}\r\n\r\n// Funci\xf3n para manejar errores 500 (Error interno del servidor)\r\nfunction servirError500(res, error) {\r\n  res.statusCode = 500; // C\xf3digo de estado HTTP para "Error interno del servidor"\r\n  res.end(`\r\n        <!DOCTYPE html>\r\n        <html>\r\n        <head>\r\n            <title>Error del Servidor</title>\r\n        </head>\r\n        <body>\r\n            <h1>Error 500 - Error Interno del Servidor</h1>\r\n            <p>Ha ocurrido un error inesperado.</p>\r\n            <pre>${error.message}</pre>\r\n            <a href="/">Volver al Inicio</a>\r\n        </body>\r\n        </html>\r\n    `);\r\n}\r\n\r\n// Iniciar el servidor y ponerlo a escuchar en el puerto especificado\r\nconst PORT = 3000;\r\nserver.listen(PORT, () => {\r\n  // Esta funci\xf3n callback se ejecuta cuando el servidor est\xe1 listo para recibir conexiones\r\n  console.log(`Servidor ejecut\xe1ndose en http://localhost:${PORT}`);\r\n});\n'})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"CARACTER\xcdSTICAS PRINCIPALES DE ESTE SERVIDOR:"})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Enrutamiento b\xe1sico"}),": Maneja rutas espec\xedficas como '/', '/acerca', '/contacto'"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Servicio de archivos est\xe1ticos"}),": Sirve CSS, JS, im\xe1genes desde el directorio 'public'"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Manejo de errores"}),": Gestiona errores 404 y 500 de manera centralizada"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Tipo MIME autom\xe1tico"}),": Detecta y establece el Content-Type correcto para archivos est\xe1ticos"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Estructura modular"}),": Separa la l\xf3gica en funciones especializadas"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Logging"}),": Registra cada solicitud recibida en la consola"]}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"Este servidor representa la base fundamental sobre la que se construyen frameworks web m\xe1s complejos como Express.js."}),"\n",(0,o.jsx)(e.h2,{id:"sistema-de-enrutamiento-avanzado-con-par\xe1metros",children:"Sistema de Enrutamiento Avanzado con Par\xe1metros"}),"\n",(0,o.jsx)(e.h3,{id:"implementaci\xf3n-de-rutas-con-par\xe1metros",children:"Implementaci\xf3n de Rutas con Par\xe1metros"}),"\n",(0,o.jsx)(e.p,{children:"Te explico este servidor API REST completo en partes:"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"PRIMERA PARTE: CONFIGURACI\xd3N INICIAL Y ESTRUCTURA DEL SERVIDOR"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:'import http from "http";\r\nimport { URL } from "url";\r\n\r\n// Base de datos simulada en memoria\r\n// En una aplicaci\xf3n real, esto estar\xeda en una base de datos externa\r\nconst usuarios = [\r\n  { id: 1, nombre: "Ana Garc\xeda", email: "ana@ejemplo.com" },\r\n  { id: 2, nombre: "Carlos L\xf3pez", email: "carlos@ejemplo.com" },\r\n  { id: 3, nombre: "Mar\xeda Rodr\xedguez", email: "maria@ejemplo.com" },\r\n];\r\n\r\n// Crear el servidor HTTP\r\nconst server = http.createServer(async (req, res) => {\r\n  // Analizar la URL solicitada para extraer ruta y par\xe1metros\r\n  const url = new URL(req.url, `http://${req.headers.host}`);\r\n  const ruta = url.pathname;\r\n\r\n  // Configurar headers para respuestas JSON\r\n  // application/json indica que todas las respuestas ser\xe1n en formato JSON\r\n  res.setHeader("Content-Type", "application/json; charset=utf-8");\r\n\r\n  try {\r\n    // Sistema de enrutamiento para la API\r\n    // Todas las rutas de la API comienzan con /api/usuarios\r\n    if (ruta.startsWith("/api/usuarios")) {\r\n      await manejarRutaUsuarios(ruta, req.method, res, url);\r\n    } else {\r\n      // Si la ruta no coincide con ning\xfan endpoint conocido\r\n      res.statusCode = 404;\r\n      res.end(JSON.stringify({ error: "Endpoint no encontrado" }));\r\n    }\r\n  } catch (error) {\r\n    // Manejo global de errores no controlados\r\n    console.error("Error:", error);\r\n    res.statusCode = 500;\r\n    res.end(JSON.stringify({ error: "Error interno del servidor" }));\r\n  }\r\n});\n'})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"SEGUNDA PARTE: MANEJO DE RUTAS Y M\xc9TODOS HTTP"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:'async function manejarRutaUsuarios(ruta, metodo, res, url) {\r\n  // Analizar la ruta para determinar si se solicita un usuario espec\xedfico\r\n  // split(\'/\') divide la ruta en partes: [\'\', \'api\', \'usuarios\', \'1\'] para /api/usuarios/1\r\n  // filter(parte => parte !== \'\') elimina las partes vac\xedas\r\n  const partesRuta = ruta.split("/").filter((parte) => parte !== "");\r\n\r\n  // Verificar si la ruta tiene un ID: /api/usuarios/1 (3 partes) vs /api/usuarios (2 partes)\r\n  const tieneId = partesRuta.length === 3 && !isNaN(partesRuta[2]);\r\n\r\n  // Manejar diferentes m\xe9todos HTTP para la ruta /api/usuarios\r\n  if (metodo === "GET") {\r\n    if (ruta === "/api/usuarios") {\r\n      // GET /api/usuarios - Listar todos los usuarios\r\n      res.statusCode = 200;\r\n      res.end(JSON.stringify(usuarios));\r\n    } else if (tieneId) {\r\n      // GET /api/usuarios/:id - Obtener un usuario espec\xedfico por ID\r\n      const userId = parseInt(partesRuta[2]);\r\n      const usuario = usuarios.find((u) => u.id === userId);\r\n\r\n      if (usuario) {\r\n        // Usuario encontrado - retornar 200 OK con los datos\r\n        res.statusCode = 200;\r\n        res.end(JSON.stringify(usuario));\r\n      } else {\r\n        // Usuario no encontrado - retornar 404 Not Found\r\n        res.statusCode = 404;\r\n        res.end(JSON.stringify({ error: "Usuario no encontrado" }));\r\n      }\r\n    }\r\n  } else if (metodo === "POST" && ruta === "/api/usuarios") {\r\n    // POST /api/usuarios - Crear un nuevo usuario\r\n    // Solo permitido en la ruta base, no en rutas con ID\r\n    await crearUsuario(req, res);\r\n  } else {\r\n    // M\xe9todo HTTP no permitido para esta ruta\r\n    // 405 Method Not Allowed\r\n    res.statusCode = 405;\r\n    res.end(JSON.stringify({ error: "M\xe9todo no permitido" }));\r\n  }\r\n}\n'})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"TERCERA PARTE: CREACI\xd3N DE USUARIOS Y MANEJO DE DATOS"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:'// Funci\xf3n para crear usuario (simplificada)\r\nfunction crearUsuario(req, res) {\r\n  let body = "";\r\n\r\n  // Los datos POST llegan en chunks (fragmentos)\r\n  // Es necesario acumular todos los chunks para obtener el cuerpo completo\r\n  req.on("data", (chunk) => {\r\n    body += chunk.toString();\r\n  });\r\n\r\n  // Cuando se han recibido todos los datos\r\n  req.on("end", () => {\r\n    try {\r\n      // Intentar parsear el cuerpo como JSON\r\n      const nuevoUsuario = JSON.parse(body);\r\n\r\n      // Asignar un nuevo ID (en una app real esto lo har\xeda la base de datos)\r\n      nuevoUsuario.id = usuarios.length + 1;\r\n\r\n      // Agregar el nuevo usuario al array\r\n      usuarios.push(nuevoUsuario);\r\n\r\n      // Retornar 201 Created con el usuario creado\r\n      res.statusCode = 201;\r\n      res.end(JSON.stringify(nuevoUsuario));\r\n    } catch (error) {\r\n      // Si el JSON es inv\xe1lido, retornar error 400 Bad Request\r\n      res.statusCode = 400;\r\n      res.end(JSON.stringify({ error: "JSON inv\xe1lido" }));\r\n    }\r\n  });\r\n}\r\n\r\n// Iniciar el servidor\r\nconst PORT = 3000;\r\nserver.listen(PORT, () => {\r\n  console.log(`API REST ejecut\xe1ndose en http://localhost:${PORT}`);\r\n});\n'})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"ENDPOINTS DISPONIBLES EN ESTA API:"})}),"\n",(0,o.jsxs)(e.ol,{children:["\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"GET /api/usuarios"})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Lista todos los usuarios"}),"\n",(0,o.jsx)(e.li,{children:"C\xf3digo: 200 OK"}),"\n",(0,o.jsx)(e.li,{children:"Respuesta: Array de usuarios"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:(0,o.jsxs)(e.strong,{children:["GET /api/usuarios/",":id"]})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Obtiene un usuario espec\xedfico"}),"\n",(0,o.jsx)(e.li,{children:"C\xf3digo: 200 OK (encontrado) o 404 Not Found (no existe)"}),"\n",(0,o.jsx)(e.li,{children:"Respuesta: Objeto usuario o mensaje de error"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(e.li,{children:["\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"POST /api/usuarios"})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"Crea un nuevo usuario"}),"\n",(0,o.jsx)(e.li,{children:"C\xf3digo: 201 Created (\xe9xito) o 400 Bad Request (JSON inv\xe1lido)"}),"\n",(0,o.jsx)(e.li,{children:"Cuerpo: JSON con los datos del usuario (sin ID)"}),"\n",(0,o.jsx)(e.li,{children:"Respuesta: Usuario creado con ID asignado"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"C\xd3DIGOS DE ESTADO HTTP UTILIZADOS:"})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"200 OK"}),": Solicitud exitosa"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"201 Created"}),": Recurso creado exitosamente"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"400 Bad Request"}),": Datos de entrada inv\xe1lidos"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"404 Not Found"}),": Recurso no encontrado"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"405 Method Not Allowed"}),": M\xe9todo HTTP no permitido para la ruta"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"500 Internal Server Error"}),": Error gen\xe9rico del servidor"]}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.strong,{children:"CARACTER\xcdSTICAS PRINCIPALES DE ESTA API:"})}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Arquitectura RESTful"}),": Sigue convenciones REST para rutas y m\xe9todos HTTP"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Manejo de m\xe9todos HTTP"}),": GET para leer, POST para crear"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Respuestas JSON"}),": Todas las respuestas est\xe1n en formato JSON"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Manejo de errores"}),": C\xf3digos de estado HTTP apropiados para diferentes errores"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Parsing de datos"}),": Manejo de cuerpos de solicitud POST en formato JSON"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Enrutamiento din\xe1mico"}),": Soporte para par\xe1metros en la URL (/api/usuarios/",":id",")"]}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"Esta API representa la estructura b\xe1sica de un servicio REST que podr\xeda extenderse con m\xe1s m\xe9todos (PUT, DELETE) y funcionalidades como autenticaci\xf3n, validaci\xf3n de datos y conexi\xf3n a base de datos real."}),"\n",(0,o.jsx)(e.h2,{id:"mejores-pr\xe1cticas-y-consideraciones",children:"Mejores Pr\xe1cticas y Consideraciones"}),"\n",(0,o.jsx)(e.h3,{id:"1-validaci\xf3n-de-rutas",children:"1. Validaci\xf3n de Rutas"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:'import path from "path";\r\n\r\n// Funci\xf3n para prevenir ataques de directory traversal\r\n// Estos ataques intentan acceder a archivos fuera del directorio permitido\r\nfunction validarRutaSegura(rutaSolicitada, directorioBase) {\r\n  // Resolver la ruta solicitada contra el directorio base\r\n  // path.resolve() combina la ruta base con la ruta solicitada y retorna una ruta absoluta\r\n  // Esto normaliza la ruta y resuelve referencias como \'..\' y \'.\'\r\n  const rutaResuelta = path.resolve(directorioBase, rutaSolicitada);\r\n\r\n  // Verificar que la ruta resuelta comience con el directorio base\r\n  // Esto asegura que el archivo solicitado est\xe9 dentro del directorio permitido\r\n  return rutaResuelta.startsWith(directorioBase);\r\n}\r\n\r\n// Ejemplo de uso en un servidor web\r\n// Directorio base donde se almacenan los archivos p\xfablicos permitidos\r\nconst directorioPublico = path.join(__dirname, "public");\r\n\r\n// Ruta potencialmente maliciosa que intenta salir del directorio p\xfablico\r\nconst rutaUsuario = "../archivo-secreto.txt";\r\n\r\n// Validar si la ruta solicitada es segura\r\nif (validarRutaSegura(rutaUsuario, directorioPublico)) {\r\n  console.log("Ruta segura");\r\n} else {\r\n  console.log("Intento de acceso no autorizado detectado");\r\n}\r\n\r\n// AN\xc1LISIS DETALLADO DE LO QUE SUCEDE:\r\n\r\n// Supongamos que:\r\n// __dirname = "/app/proyecto"\r\n// directorioPublico = "/app/proyecto/public"\r\n// rutaUsuario = "../archivo-secreto.txt"\r\n\r\n// path.resolve(directorioPublico, rutaUsuario) hace:\r\n// 1. Comienza con "/app/proyecto/public"\r\n// 2. Agrega "../archivo-secreto.txt"\r\n// 3. El \'..\' sube un nivel: "/app/proyecto/archivo-secreto.txt"\r\n\r\n// La validaci\xf3n compara:\r\n// rutaResuelta = "/app/proyecto/archivo-secreto.txt"\r\n// directorioBase = "/app/proyecto/public"\r\n\r\n// "/app/proyecto/archivo-secreto.txt".startsWith("/app/proyecto/public") = false\r\n// Por lo tanto, se detecta como ruta no segura\r\n\r\n// M\xc1S EJEMPLOS PR\xc1CTICOS:\r\n\r\n// Ejemplo 1: Ruta segura dentro del directorio p\xfablico\r\nconst rutaSegura = "css/estilos.css";\r\nconsole.log(validarRutaSegura(rutaSegura, directorioPublico)); // true\r\n\r\n// path.resolve("/app/proyecto/public", "css/estilos.css")\r\n// = "/app/proyecto/public/css/estilos.css"\r\n// Comienza con "/app/proyecto/public" \u2192 true\r\n\r\n// Ejemplo 2: Ataque con m\xfaltiples directorios padres\r\nconst rutaMaliciosa = "../../../../etc/passwd";\r\nconsole.log(validarRutaSegura(rutaMaliciosa, directorioPublico)); // false\r\n\r\n// Ejemplo 3: Ruta con normalizaci\xf3n\r\nconst rutaConBarras = "subcarpeta//archivo.txt";\r\nconsole.log(validarRutaSegura(rutaConBarras, directorioPublico)); // true\r\n\r\n// path.resolve normaliza las barras dobles\r\n\r\n// CASOS ESPECIALES A CONSIDERAR:\r\n\r\n// Caso 1: Directorio base con trailing slash\r\nconst directorioConSlash = directorioPublico + "/";\r\nconsole.log(validarRutaSegura("archivo.txt", directorioConSlash)); // true\r\n\r\n// Caso 2: Rutas absolutas (siempre deben ser rechazadas si no coinciden con el base)\r\nconst rutaAbsoluta = "/otra/carpeta/archivo.txt";\r\nconsole.log(validarRutaSegura(rutaAbsoluta, directorioPublico)); // false\r\n\r\n// Caso 3: En sistemas Windows (rutas con backslash)\r\n// path.resolve() maneja autom\xe1ticamente las diferencias entre sistemas\r\n\r\n// MEJORA DE LA FUNCI\xd3N PARA MAYOR SEGURIDAD:\r\n\r\nfunction validarRutaSeguraMejorada(rutaSolicitada, directorioBase) {\r\n  // Normalizar el directorio base para asegurar formato consistente\r\n  const directorioBaseNormalizado = path.resolve(directorioBase) + path.sep;\r\n\r\n  // Resolver la ruta solicitada\r\n  const rutaResuelta = path.resolve(directorioBase, rutaSolicitada);\r\n\r\n  // Asegurar que la ruta resuelta termine con separator si es directorio\r\n  const rutaResueltaNormalizada = rutaResuelta + path.sep;\r\n\r\n  // Verificar que comience con el directorio base normalizado\r\n  return rutaResueltaNormalizada.startsWith(directorioBaseNormalizado);\r\n}\r\n\r\n// USO EN CONTEXTO REAL DE SERVIDOR WEB:\r\n\r\nfunction servirArchivoSeguro(rutaSolicitada, res) {\r\n  const directorioBase = path.join(__dirname, "public");\r\n\r\n  if (!validarRutaSegura(rutaSolicitada, directorioBase)) {\r\n    res.statusCode = 403; // Forbidden\r\n    res.end("Acceso denegado");\r\n    return;\r\n  }\r\n\r\n  // Si la ruta es segura, proceder a servir el archivo\r\n  const rutaCompleta = path.join(directorioBase, rutaSolicitada);\r\n  // ... l\xf3gica para leer y servir el archivo\r\n}\n'})}),"\n",(0,o.jsx)(e.h3,{id:"2-configuraci\xf3n-de-mime-types",children:"2. Configuraci\xf3n de MIME Types"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:"// Mapeo de extensiones de archivo a tipos MIME\r\n// Los tipos MIME (Multipurpose Internet Mail Extensions) indican al navegador\r\n// qu\xe9 tipo de contenido se est\xe1 sirviendo y c\xf3mo debe interpretarlo\r\nconst tiposMIME = {\r\n    '.html': 'text/html',                    // Documentos HTML\r\n    '.css': 'text/css',                      // Hojas de estilo CSS\r\n    '.js': 'application/javascript',         // C\xf3digo JavaScript\r\n    '.json': 'application/json',             // Datos en formato JSON\r\n    '.png': 'image/png',                     // Im\xe1genes PNG\r\n    '.jpg': 'image/jpeg',                    // Im\xe1genes JPEG\r\n    '.gif': 'image/gif',                     // Im\xe1genes GIF animadas\r\n    '.svg': 'image/svg+xml',                 // Gr\xe1ficos vectoriales SVG\r\n    '.ico': 'image/x-icon'                   // Iconos de favoritos\r\n};\r\n\r\n// Funci\xf3n para determinar el tipo MIME basado en la extensi\xf3n del archivo\r\nfunction obtenerTipoMIME(archivo) {\r\n    // Extraer la extensi\xf3n del archivo usando path.extname()\r\n    // toLowerCase() asegura que la extensi\xf3n est\xe9 en min\xfasculas para coincidir con las claves del objeto\r\n    const extension = path.extname(archivo).toLowerCase();\r\n\r\n    // Buscar el tipo MIME en el objeto de mapeo\r\n    // Si la extensi\xf3n no est\xe1 en el objeto, retorna 'application/octet-stream' como valor por defecto\r\n    // 'application/octet-stream' indica datos binarios gen\xe9ricos\r\n    return tiposMIME[extension] || 'application/octet-stream';\r\n}\r\n\r\n// EJEMPLOS DE USO Y COMPORTAMIENTO:\r\n\r\n// Ejemplo 1: Archivo HTML\r\nconsole.log(obtenerTipoMIME('/ruta/index.html'));\r\n// '.html' \u2192 'text/html'\r\n\r\n// Ejemplo 2: Archivo CSS\r\nconsole.log(obtenerTipoMIME('estilos/principal.css'));\r\n// '.css' \u2192 'text/css'\r\n\r\n// Ejemplo 3: Archivo con extensi\xf3n en may\xfasculas\r\nconsole.log(obtenerTipoMIME('script.JS'));\r\n// '.JS' convertido a '.js' \u2192 'application/javascript'\r\n\r\n// Ejemplo 4: Archivo con extensi\xf3n no registrada\r\nconsole.log(obtenerTipoMIME('documento.pdf'));\r\n// '.pdf' no existe en tiposMIME \u2192 'application/octet-stream'\r\n\r\n// Ejemplo 5: Archivo sin extensi\xf3n\r\nconsole.log(obtenerTipoMIME('README'));\r\n// '' (cadena vac\xeda) \u2192 'application/octet-stream'\r\n\r\n// USO EN CONTEXTO REAL DE UN SERVIDOR WEB:\r\n\r\nfunction servirArchivoEstatico(rutaSolicitada, res) {\r\n    try {\r\n        // Leer el archivo del sistema de archivos\r\n        const contenido = await fs.readFile(rutaCompleta);\r\n\r\n        // Determinar el tipo MIME apropiado\r\n        const tipoMIME = obtenerTipoMIME(rutaSolicitada);\r\n\r\n        // Establecer el header Content-Type\r\n        res.setHeader('Content-Type', tipoMIME);\r\n\r\n        // Enviar el contenido\r\n        res.end(contenido);\r\n\r\n    } catch (error) {\r\n        // Manejo de errores...\r\n    }\r\n}\r\n\r\n// VERSI\xd3N MEJORADA CON M\xc1S TIPOS MIME COMUNES:\r\n\r\nconst tiposMIMECompletos = {\r\n    // Documentos y texto\r\n    '.html': 'text/html',\r\n    '.htm': 'text/html',\r\n    '.css': 'text/css',\r\n    '.txt': 'text/plain',\r\n    '.md': 'text/markdown',\r\n    '.xml': 'application/xml',\r\n\r\n    // Scripts y c\xf3digo\r\n    '.js': 'application/javascript',\r\n    '.mjs': 'application/javascript',\r\n    '.jsx': 'application/javascript',\r\n    '.ts': 'application/typescript',\r\n\r\n    // Datos y formatos de intercambio\r\n    '.json': 'application/json',\r\n    '.pdf': 'application/pdf',\r\n    '.zip': 'application/zip',\r\n\r\n    // Im\xe1genes\r\n    '.png': 'image/png',\r\n    '.jpg': 'image/jpeg',\r\n    '.jpeg': 'image/jpeg',\r\n    '.gif': 'image/gif',\r\n    '.svg': 'image/svg+xml',\r\n    '.webp': 'image/webp',\r\n    '.bmp': 'image/bmp',\r\n    '.ico': 'image/x-icon',\r\n    '.avif': 'image/avif',\r\n\r\n    // Fuentes\r\n    '.woff': 'font/woff',\r\n    '.woff2': 'font/woff2',\r\n    '.ttf': 'font/ttf',\r\n    '.eot': 'application/vnd.ms-fontobject',\r\n\r\n    // Audio y video\r\n    '.mp3': 'audio/mpeg',\r\n    '.wav': 'audio/wav',\r\n    '.mp4': 'video/mp4',\r\n    '.webm': 'video/webm'\r\n};\r\n\r\n// FUNCI\xd3N MEJORADA CON MANEJO DE PAR\xc1METROS ADICIONALES:\r\n\r\nfunction obtenerTipoMIMECompleto(archivo, charset = 'utf-8') {\r\n    const extension = path.extname(archivo).toLowerCase();\r\n    let tipoMIME = tiposMIMECompletos[extension] || 'application/octet-stream';\r\n\r\n    // Agregar charset para tipos de texto que lo soportan\r\n    if (tipoMIME.startsWith('text/') && !tipoMIME.includes('charset')) {\r\n        tipoMIME += `; charset=${charset}`;\r\n    }\r\n\r\n    return tipoMIME;\r\n}\r\n\r\n// Ejemplo con charset:\r\nconsole.log(obtenerTipoMIMECompleto('index.html'));\r\n// 'text/html; charset=utf-8'\r\n\r\n// IMPORTANCIA DE LOS TIPOS MIME CORRECTOS:\r\n\r\n// 1. Renderizado adecuado: El navegador sabe c\xf3mo interpretar el contenido\r\n// 2. Seguridad: Tipos incorrectos pueden causar vulnerabilidades XSS\r\n// 3. Performance: Algunos tipos permiten compresi\xf3n o optimizaciones espec\xedficas\r\n// 4. Compatibilidad: Asegura que los recursos se carguen correctamente en todos los navegadores\r\n\r\n// CASOS ESPECIALES A CONSIDERAR:\r\n\r\n// Archivos que deben ser forzados a descarga:\r\nfunction esTipoDescargable(tipoMIME) {\r\n    const tiposParaDescargar = [\r\n        'application/pdf',\r\n        'application/zip',\r\n        'application/octet-stream'\r\n    ];\r\n    return tiposParaDescargar.includes(tipoMIME);\r\n}\r\n\r\n// En un servidor, para forzar descarga en lugar de visualizaci\xf3n:\r\nif (esTipoDescargable(tipoMIME)) {\r\n    res.setHeader('Content-Disposition', 'attachment; filename=\"' + path.basename(archivo) + '\"');\r\n}\n"})}),"\n",(0,o.jsx)(e.h3,{id:"3-manejo-de-errores-centralizado",children:"3. Manejo de Errores Centralizado"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-javascript",children:'// Clase para manejar respuestas de error HTTP de manera consistente\r\n// Se utiliza static methods para no necesitar crear instancias de la clase\r\n// Esto permite un uso directo como ManejadorErrores.notFound(res)\r\nclass ManejadorErrores {\r\n  // M\xe9todo para errores 404 - Recurso no encontrado\r\n  // Se usa cuando el cliente solicita un recurso que no existe\r\n  static notFound(res, mensaje = "Recurso no encontrado") {\r\n    // Establecer c\xf3digo de estado HTTP 404\r\n    res.statusCode = 404;\r\n    // Enviar respuesta en formato JSON con el mensaje de error\r\n    res.end(JSON.stringify({ error: mensaje }));\r\n  }\r\n\r\n  // M\xe9todo para errores 500 - Error interno del servidor\r\n  // Se usa para errores inesperados en el servidor\r\n  static serverError(res, error) {\r\n    // Registrar el error completo en la consola del servidor para debugging\r\n    console.error("Error del servidor:", error);\r\n    // Establecer c\xf3digo de estado HTTP 500\r\n    res.statusCode = 500;\r\n    // Enviar respuesta gen\xe9rica al cliente (no exponer detalles internos)\r\n    res.end(JSON.stringify({ error: "Error interno del servidor" }));\r\n  }\r\n\r\n  // M\xe9todo para errores 400 - Solicitud incorrecta\r\n  // Se usa cuando el cliente env\xeda datos mal formados o inv\xe1lidos\r\n  static badRequest(res, mensaje = "Solicitud inv\xe1lida") {\r\n    // Establecer c\xf3digo de estado HTTP 400\r\n    res.statusCode = 400;\r\n    // Enviar respuesta con mensaje espec\xedfico sobre el error en la solicitud\r\n    res.end(JSON.stringify({ error: mensaje }));\r\n  }\r\n}\r\n\r\n// EJEMPLOS DE USO EN UN SERVIDOR WEB:\r\n\r\n// En el manejo de rutas de un servidor\r\nimport http from "http";\r\n\r\nconst server = http.createServer(async (req, res) => {\r\n  const url = new URL(req.url, `http://${req.headers.host}`);\r\n  const ruta = url.pathname;\r\n\r\n  // Configurar header para respuestas JSON\r\n  res.setHeader("Content-Type", "application/json");\r\n\r\n  try {\r\n    if (ruta === "/api/usuarios") {\r\n      // L\xf3gica para manejar usuarios...\r\n    } else if (ruta.startsWith("/api/usuarios/")) {\r\n      // L\xf3gica para usuario espec\xedfico...\r\n    } else {\r\n      // Ruta no encontrada - usar el manejador de errores\r\n      ManejadorErrores.notFound(res, `La ruta ${ruta} no existe`);\r\n    }\r\n  } catch (error) {\r\n    // Error inesperado - usar el manejador de errores del servidor\r\n    ManejadorErrores.serverError(res, error);\r\n  }\r\n});\r\n\r\n// EJEMPLOS ESPEC\xcdFICOS DE CADA M\xc9TODO:\r\n\r\n// Ejemplo 1: Recurso no encontrado\r\nfunction obtenerUsuario(userId, res) {\r\n  const usuario = buscarUsuarioEnBD(userId);\r\n  if (!usuario) {\r\n    ManejadorErrores.notFound(res, `Usuario con ID ${userId} no encontrado`);\r\n    return;\r\n  }\r\n  // Continuar con la l\xf3gica si el usuario existe...\r\n}\r\n\r\n// Ejemplo 2: Validaci\xf3n de datos de entrada\r\nfunction crearUsuario(datosUsuario, res) {\r\n  if (!datosUsuario.nombre || !datosUsuario.email) {\r\n    ManejadorErrores.badRequest(res, "Nombre y email son requeridos");\r\n    return;\r\n  }\r\n\r\n  if (!validarEmail(datosUsuario.email)) {\r\n    ManejadorErrores.badRequest(res, "Formato de email inv\xe1lido");\r\n    return;\r\n  }\r\n\r\n  // Continuar con la creaci\xf3n del usuario...\r\n}\r\n\r\n// Ejemplo 3: Error inesperado en base de datos\r\nasync function obtenerProductos(res) {\r\n  try {\r\n    const productos = await database.query("SELECT * FROM productos");\r\n    res.end(JSON.stringify(productos));\r\n  } catch (error) {\r\n    ManejadorErrores.serverError(res, error);\r\n  }\r\n}\r\n\r\n// EXTENSI\xd3N DE LA CLASE CON M\xc1S TIPOS DE ERRORES:\r\n\r\nclass ManejadorErroresExtendido extends ManejadorErrores {\r\n  // Error 401 - No autorizado\r\n  static unauthorized(res, mensaje = "No autorizado") {\r\n    res.statusCode = 401;\r\n    res.end(JSON.stringify({ error: mensaje }));\r\n  }\r\n\r\n  // Error 403 - Prohibido\r\n  static forbidden(res, mensaje = "Acceso denegado") {\r\n    res.statusCode = 403;\r\n    res.end(JSON.stringify({ error: mensaje }));\r\n  }\r\n\r\n  // Error 409 - Conflicto\r\n  static conflict(res, mensaje = "Conflicto con el recurso") {\r\n    res.statusCode = 409;\r\n    res.end(JSON.stringify({ error: mensaje }));\r\n  }\r\n\r\n  // Error 422 - Entidad no procesable\r\n  static unprocessable(res, mensaje = "Entidad no procesable") {\r\n    res.statusCode = 422;\r\n    res.end(JSON.stringify({ error: mensaje }));\r\n  }\r\n}\r\n\r\n// VENTAJAS DE ESTE ENFOQUE:\r\n\r\n// 1. Consistencia: Todas las respuestas de error siguen el mismo formato\r\n// 2. Mantenibilidad: Los cambios en el formato de errores se hacen en un solo lugar\r\n// 3. Reutilizaci\xf3n: El mismo manejo de errores se usa en toda la aplicaci\xf3n\r\n// 4. Separaci\xf3n de concerns: La l\xf3gica de negocio no se mezcla con el manejo de errores HTTP\r\n\r\n// USO CON M\xc9TODOS DE AUTENTICACI\xd3N:\r\n\r\nfunction middlewareAutenticacion(req, res, next) {\r\n  const token = req.headers.authorization;\r\n\r\n  if (!token) {\r\n    ManejadorErroresExtendido.unauthorized(\r\n      res,\r\n      "Token de autenticaci\xf3n requerido"\r\n    );\r\n    return;\r\n  }\r\n\r\n  if (!validarToken(token)) {\r\n    ManejadorErroresExtendido.forbidden(res, "Token inv\xe1lido o expirado");\r\n    return;\r\n  }\r\n\r\n  // Si la autenticaci\xf3n es exitosa, continuar\r\n  next();\r\n}\r\n\r\n// FORMATO ALTERNATIVO DE RESPUESTA DE ERROR:\r\n\r\nclass ManejadorErroresDetallado {\r\n  static notFound(res, mensaje = "Recurso no encontrado", detalles = {}) {\r\n    res.statusCode = 404;\r\n    res.end(\r\n      JSON.stringify({\r\n        error: mensaje,\r\n        codigo: "NOT_FOUND",\r\n        detalles: detalles,\r\n        timestamp: new Date().toISOString(),\r\n      })\r\n    );\r\n  }\r\n}\r\n\r\n// Ejemplo de uso con detalles adicionales:\r\nManejadorErroresDetallado.notFound(res, "Usuario no encontrado", {\r\n  userId: 12345,\r\n  recurso: "usuarios",\r\n  sugerencia: "Verifique que el ID sea correcto",\r\n});\n'})}),"\n",(0,o.jsx)(e.h2,{id:"conclusi\xf3n",children:"Conclusi\xf3n"}),"\n",(0,o.jsxs)(e.p,{children:["Node.js proporciona herramientas robustas para el manejo de rutas a trav\xe9s de sus m\xf3dulos nativos ",(0,o.jsx)(e.code,{children:"path"})," y ",(0,o.jsx)(e.code,{children:"url"}),". Con ES Modules, el enfoque ha evolucionado pero mantiene la misma funcionalidad poderosa. La clave est\xe1 en:"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Entender la diferencia"})," entre CommonJS y ES Modules para ",(0,o.jsx)(e.code,{children:"__dirname"})," y ",(0,o.jsx)(e.code,{children:"__filename"})]}),"\n",(0,o.jsxs)(e.li,{children:["Usar ",(0,o.jsx)(e.code,{children:"path.join()"})," y ",(0,o.jsx)(e.code,{children:"path.resolve()"})," para construir rutas de manera segura"]}),"\n",(0,o.jsxs)(e.li,{children:["Utilizar la clase ",(0,o.jsx)(e.code,{children:"URL"})," para parsear y manipular URLs"]}),"\n",(0,o.jsx)(e.li,{children:"Implementar validaci\xf3n de seguridad para prevenir ataques de directory traversal"}),"\n",(0,o.jsx)(e.li,{children:"Crear sistemas de enrutamiento modulares y mantenibles"}),"\n",(0,o.jsx)(e.li,{children:"Manejar adecuadamente los errores y tipos MIME"}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"Este enfoque nativo es fundamental para entender c\xf3mo funcionan los frameworks web en Node.js y proporciona una base s\xf3lida para construir aplicaciones web robustas y seguras."})]})}function u(r={}){const{wrapper:e}={...(0,s.R)(),...r.components};return e?(0,o.jsx)(e,{...r,children:(0,o.jsx)(d,{...r})}):d(r)}},8453:(r,e,n)=>{n.d(e,{R:()=>t,x:()=>i});var a=n(6540);const o={},s=a.createContext(o);function t(r){const e=a.useContext(s);return a.useMemo(function(){return"function"==typeof r?r(e):{...e,...r}},[e,r])}function i(r){let e;return e=r.disableParentContext?"function"==typeof r.components?r.components(o):r.components||o:t(r.components),a.createElement(s.Provider,{value:e},r.children)}}}]);